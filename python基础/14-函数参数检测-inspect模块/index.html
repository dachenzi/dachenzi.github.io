<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>14-函数参数检测-inspect模块  &middot; dahl&#39;s blog</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="">


<meta property="og:title" content="14-函数参数检测-inspect模块  &middot; dahl&#39;s blog ">
<meta property="og:site_name" content="dahl&#39;s blog"/>
<meta property="og:url" content="https://dachenzi.github.io/python%E5%9F%BA%E7%A1%80/14-%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E6%A3%80%E6%B5%8B-inspect%E6%A8%A1%E5%9D%97/" />
<meta property="og:locale" content="en-EN">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="0001-01-01T00:00:00Z" />
<meta property="og:article:modified_time" content="0001-01-01T00:00:00Z" />

  
    
  

  

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "14-函数参数检测-inspect模块",
    "author": {
      "@type": "Person",
      "name": "daxin.li"
    },
    "datePublished": "0001-01-01",
    "description": "",
    "wordCount":  434 
  }
</script>



<link rel="canonical" href="https://dachenzi.github.io/python%E5%9F%BA%E7%A1%80/14-%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E6%A3%80%E6%B5%8B-inspect%E6%A8%A1%E5%9D%97/" />

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://dachenzi.github.io/touch-icon-144-precomposed.png">
<link href="https://dachenzi.github.io/favicon.png" rel="icon">

<meta name="generator" content="Hugo 0.75.1" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link href='https://fonts.googleapis.com/css?family=Merriweather:300%7CRaleway%7COpen+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/highlight/default.css">

  
  
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'Your Google Analytics tracking code', 'auto');
	  ga('send', 'pageview');

	</script>

</head>
<body>
  <main id="main-wrapper" class="container main_wrapper has-sidebar">
    <header id="main-header" class="container main_header">
  <div class="container brand">
  <div class="container title h1-like">
  <a class="baselink" href="https://dachenzi.github.io">
  foobar

</a>

</div>

  
<div class="container topline">
  
  few words about your site


</div>


</div>

  <nav class="container nav primary no-print">
  

<a class="homelink" href="https://dachenzi.github.io">home</a>


  
<a href="https://dachenzi.github.io/about">About</a>

<a href="https://dachenzi.github.io/post" title="Show list of posts">Posts</a>

<a href="https://dachenzi.github.io/tags" title="Show list of tags">Tags</a>


</nav>

<div class="container nav secondary no-print">
  
<a id="contact-link-email" class="contact_link" rel="me" aria-label="Email" href="mailto:dahlhin.li@gmail.com">
  <span class="fa fa-envelope-square"></span></a>



<a id="contact-link-github" class="contact_link" rel="me" aria-label="Github" href="https://github.com/enten/hugo-boilerplate">
  <span class="fa fa-github-square"></span></a>




 


















</div>


  

</header>


<article id="main-content" class="container main_content single">
  <header class="container hat">
  <h1>14-函数参数检测-inspect模块
</h1>

</header>

  <div class="container content">
  <p>{% raw %}</p>
<p><!-- raw HTML omitted --><strong>文章目录</strong><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<ul>
<li><a href="#1-python%E7%B1%BB%E5%9E%8B%E6%B3%A8%E8%A7%A3">1 python类型注解</a></li>
<li><a href="#2-%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89%E7%9A%84%E5%BC%8A%E7%AB%AF">2 函数定义的弊端</a></li>
<li><a href="#3-%E5%87%BD%E6%95%B0%E6%96%87%E6%A1%A3">3 函数文档</a></li>
<li><a href="#4-%E5%87%BD%E6%95%B0%E6%B3%A8%E8%A7%A3">4 函数注解</a>
<ul>
<li><a href="#41-annotation%E5%B1%9E%E6%80%A7">4.1 annotation属性</a></li>
</ul>
</li>
<li><a href="#5-inspect%E6%A8%A1%E5%9D%97">5 inspect模块</a>
<ul>
<li><a href="#51-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95">5.1 常用方法</a></li>
<li><a href="#52-signature%E7%B1%BB">5.2 signature类</a></li>
<li><a href="#53-parameters%E5%B1%9E%E6%80%A7">5.3 parameters属性</a></li>
<li><a href="#54-%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8F%82%E6%95%B0%E7%AD%BE%E5%90%8D">5.4 获取对象的参数签名</a></li>
</ul>
</li>
<li><a href="#6-%E6%A3%80%E6%9F%A5%E5%8F%82%E6%95%B0">6 检查参数</a></li>
</ul>
<!-- raw HTML omitted -->
<h1 id="1-python类型注解">1 python类型注解</h1>
<p>        类型注解，即对变量的类型，进行标注或者说明，因为Python是一门动态编译型语言，我们无法在赋值时就定义它的变量类型，所以在<code>Python3.5</code>以上版本新增了类型注解，但仅仅是提示作用，并不能严格控制，这是动态编译型语言的通病，下面来仔细看一下什么是Python的类型注解。</p>
<h1 id="2-函数定义的弊端">2 函数定义的弊端</h1>
<p>        Python是动态语言，变量随时可以被赋值，且赋值为不同的类型，这就与静态语言不同了，变量的类型是在运行期决定的，而静态语言事先就已经定义好了变量的类型了。这是动态语言方便之处，但也是一种弊端，我们无法控制变量的类型，也就无法控制异常的产生。举个栗子</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x,y):
    <span style="color:#66d9ef">return</span> x <span style="color:#f92672">+</span> y 
<span style="color:#66d9ef">print</span>(add(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>))
<span style="color:#66d9ef">print</span>(add(<span style="color:#e6db74">&#39;s&#39;</span>,<span style="color:#e6db74">&#39;b&#39;</span>))
<span style="color:#66d9ef">print</span>(add(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;a&#39;</span>))
</code></pre></div><p>        当用户传入两个数字时，返回它们的和，但是如果我们传递其他变量呢？比如字符串，因为Python中实现了+号的类型重载，所以说两个字符串的确可以加，但是如果是数字和字符串呢？在Python这种强类型语言中来说，属于非法操作(javascript会隐式转换)，而这时，我们就需要对用户传入的数据进行类型判断，不符合本函数的需求，那么就抛个异常，或者提示等等操作，这样就不会引起后续代码在执行期崩溃。如何解决呢？其实主要有两种方式。</p>
<ul>
<li>函数文档</li>
<li>函数注解</li>
</ul>
<h1 id="3-函数文档">3 函数文档</h1>
<p>        在函数中插入说明性文档的方式成为函数文档。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x, y):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    This function used to add something
</span><span style="color:#e6db74">    :param x: int object
</span><span style="color:#e6db74">    :param y: int object
</span><span style="color:#e6db74">    :return: int object
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    <span style="color:#66d9ef">return</span> x <span style="color:#f92672">+</span> y
</code></pre></div><p>在函数中，一般是定义语句后的首行使用三对双引号表示。通常存储在函数的__doc__属性中。当用户使用help(函数)时，会被打印在屏幕上。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">68</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x, y):
    <span style="color:#f92672">...</span>:     <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    ...:     This function used to add something
</span><span style="color:#e6db74">    ...:     :param x: int object
</span><span style="color:#e6db74">    ...:     :param y: int object
</span><span style="color:#e6db74">    ...:     :return: int object
</span><span style="color:#e6db74">    ...:     &#34;&#34;&#34;</span>
    <span style="color:#f92672">...</span>:     <span style="color:#66d9ef">return</span> x <span style="color:#f92672">+</span> y
    <span style="color:#f92672">...</span>:

In [<span style="color:#ae81ff">69</span>]: help(add)
Help on function add <span style="color:#f92672">in</span> module __main__:

add(x, y)
    This function used to add something
    :param x: int object
    :param y: int object
    :<span style="color:#66d9ef">return</span>: int object


In [<span style="color:#ae81ff">70</span>]: <span style="color:#66d9ef">print</span>(add<span style="color:#f92672">.</span>__doc__)

    This function used to add something
    :param x: int object
    :param y: int object
    :<span style="color:#66d9ef">return</span>: int object

In [<span style="color:#ae81ff">71</span>]:
</code></pre></div><blockquote>
<p>每次都要使用help来查看函数的说明，的确可以让使用者了解函数的参数以及返回值的类型，但并不是所有人都愿意写doc的，在这个所谓的敏捷开发时代，人们大多会以敏捷开发为借口没时间写，所以这种方法不是很用。</p>
</blockquote>
<h1 id="4-函数注解">4 函数注解</h1>
<p>        Python的函数注解是什么呢？首先来看一下如下代码：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x: int, y: int) <span style="color:#f92672">-&gt;</span> int:
    <span style="color:#66d9ef">return</span> x <span style="color:#f92672">+</span> y
</code></pre></div><ul>
<li>函数的位置形参，和默认值形参后使用冒号分隔，后面用于标识变量期望的类型。</li>
<li>在def语句末尾，使用-&gt;符号后 指定用于标识函数执行后的返回值类型。</li>
</ul>
<p>完成以上定义后，，主要的差别如下图：<br>
<img src="photo/zhushi.png" alt="zhushi1"></p>
<blockquote>
<p>当我们在IDE中准备传入非注释类型变量时，IDE会帮我们进行颜色提示，用于表示这里传入的变量有点问题。在编写时我们尚且可以使用这种方式，对我们产生一点&rsquo;警示'，但是当我们写的函数被其他人调用的时候，那么就无法进行&rsquo;提示&rsquo;了，这个时候，我们就需要对传入的参数进行类型检查了。</p>
</blockquote>
<p>我们来总结一下：</p>
<ul>
<li>函数注解在Python3.5中引入</li>
<li>对函数的参数、返回值进行类型注解</li>
<li>只对函数的参数做一个辅助的说明，并不对函数参数进行类型检查</li>
<li>提供给第三方工具，做代码分析，发现隐藏的BUG</li>
<li>函数注解的信息，保存在函数的<code>__annotation__</code>属性中。</li>
</ul>
<blockquote>
<p><code>python3.6</code> 以上还添加了变量的注解：<code>i:int = 10</code>,当然也只是提示的作用。</p>
</blockquote>
<h2 id="41-annotation属性">4.1 annotation属性</h2>
<p>在Python中使用__开头的表示符一般被用特殊属性，<code>__annotation__</code>存储的就是函数的签名信息</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">71</span>]: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x: int, y: int) <span style="color:#f92672">-&gt;</span> int:
    <span style="color:#f92672">...</span>:     <span style="color:#66d9ef">return</span> x <span style="color:#f92672">+</span> y
    <span style="color:#f92672">...</span>:

In [<span style="color:#ae81ff">73</span>]: add<span style="color:#f92672">.</span>__annotations__
Out[<span style="color:#ae81ff">73</span>]: {<span style="color:#e6db74">&#39;x&#39;</span>: int, <span style="color:#e6db74">&#39;y&#39;</span>: int, <span style="color:#e6db74">&#39;return&#39;</span>: int}
</code></pre></div><p>        当我们使用变量注释时，变量名和类型就会存放在函数的__annotations__属性中。那么即然有变量存储，那么我们是不是只需要获取传入的参数，然后和annotations中存储的变量类型进行比较是不是就达到目的了呢？仔细思考一下：</p>
<ol>
<li>参数检查势必要在函数执行前，想要在add执行前添加参数判断那么就需要使用装饰器了</li>
<li>__annotations__的值是一个字典，字典是无序的，用户按照位置传进来参数是有序的，如何让它们形成对应关系方便我们检测呢？</li>
</ol>
<p>下面我们来了解一下inspect模块，它可以帮我们完成这个事情。</p>
<h1 id="5-inspect模块">5 inspect模块</h1>
<p>        官方解释如下：inspect模块提供了几个有用的函数来帮助获取关于活动对象的信息，例如模块、类、方法、函数、回溯、框架对象和代码对象。例如，它可以帮助您检查类的内容、检索方法的源代码、提取并格式化函数的参数列表，或者获取显示详细回溯所需的所有信息。</p>
<h2 id="51-常用方法">5.1 常用方法</h2>
<table>
<thead>
<tr>
<th style="text-align:left">分类</th>
<th style="text-align:left">方法名称</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">判断</td>
<td style="text-align:left">inspect.getmodulename(path)</td>
<td style="text-align:left">获取模块名称</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">inspect.ismodule(object)</td>
<td style="text-align:left">是不是个模块</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">inspect.isclass(object)</td>
<td style="text-align:left">是不是个类</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">inspect.ismethod(object)</td>
<td style="text-align:left">是不是一个方法</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">inspect.isfunction(object)</td>
<td style="text-align:left">是不是一个函数</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">inspect.isgeneratorfunction(object)</td>
<td style="text-align:left">是不是一个生成器函数</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">inspect.isgenerator(object)</td>
<td style="text-align:left">是不是一个生成器</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">inspect.iscoroutinefunction(object)</td>
<td style="text-align:left">是不是一个协程函数</td>
</tr>
<tr>
<td style="text-align:left">获取信息</td>
<td style="text-align:left">inspect.getmodulename(path)</td>
<td style="text-align:left">获取模块名称</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">inspect.getsource(object)</td>
<td style="text-align:left">获取对象的原码(并不会解析装饰器原码)</td>
</tr>
</tbody>
</table>
<h2 id="52-signature类">5.2 signature类</h2>
<p>        首先我们要说的是函数的签名信息：它包含了了函数的函数名、它的参数类型，它所在的类和名称空间及其他信息，签名对象(signature object)表示可调用对象的调用签名信息和它的注解信息，当我们使用signature()时，它会重新返回一个包含可调用对象信息的签名对象。</p>
<h2 id="53-parameters属性">5.3 parameters属性</h2>
<p>        signature类的<code>parameters</code>属性，它里面存放的是函数的参数注解和返回值注解，组成的有序字典，其中参数注解的格式为：参数名称，使用inspect.Parameters类包装的参数注解，这个参数注解很强大，它包含如下常用的方法：</p>
<table>
<thead>
<tr>
<th style="text-align:left">方法名称</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">empty</td>
<td style="text-align:left">等同于inspect._empty表示一个参数没有被类型注释</td>
</tr>
<tr>
<td style="text-align:left">name</td>
<td style="text-align:left">参数的名称</td>
</tr>
<tr>
<td style="text-align:left">default</td>
<td style="text-align:left">参数的默认值，如果一个参数没有默认值，这个属性的值为inspect.empty</td>
</tr>
<tr>
<td style="text-align:left">annotation</td>
<td style="text-align:left">参数的注解类型，如果参数没有定义注解，这个属性的值为inspect.empty</td>
</tr>
<tr>
<td style="text-align:left">kind</td>
<td style="text-align:left">参数的类型</td>
</tr>
<tr>
<td style="text-align:left">这里的参数类型表示的是inspect内置参数类型(其实就是几个常用的函数参数定义类型而已，只是换个名字而已)</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">_POSITIONAL_ONLY         <span style="color:#f92672">=</span> _ParameterKind<span style="color:#f92672">.</span>POSITIONAL_ONLY       <span style="color:#75715e"># 位置参数_only</span>
_POSITIONAL_OR_KEYWORD   <span style="color:#f92672">=</span> _ParameterKind<span style="color:#f92672">.</span>POSITIONAL_OR_KEYWORD <span style="color:#75715e"># 位置或关键字参数</span>
_VAR_POSITIONAL          <span style="color:#f92672">=</span> _ParameterKind<span style="color:#f92672">.</span>VAR_POSITIONAL        <span style="color:#75715e"># 可变位置参数</span>
_KEYWORD_ONLY            <span style="color:#f92672">=</span> _ParameterKind<span style="color:#f92672">.</span>KEYWORD_ONLY          <span style="color:#75715e"># keyword-only参数</span>
_VAR_KEYWORD             <span style="color:#f92672">=</span> _ParameterKind<span style="color:#f92672">.</span>VAR_KEYWORD           <span style="color:#75715e"># 可变关键字参数</span>
</code></pre></div><blockquote>
<p>其中POSITIONAL_ONLY，Python中没有被实现。</p>
</blockquote>
<h2 id="54-获取对象的参数签名">5.4 获取对象的参数签名</h2>
<p>根据上面讲的方法，我们可以通过如下方式，简单的获取参数的签名：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#ae81ff">11</span>]: <span style="color:#f92672">import</span> inspect
    <span style="color:#f92672">...</span>:
    <span style="color:#f92672">...</span>: <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x: int, y: int) <span style="color:#f92672">-&gt;</span> int:
    <span style="color:#f92672">...</span>:     <span style="color:#66d9ef">return</span> x <span style="color:#f92672">+</span> y
    <span style="color:#f92672">...</span>:
    <span style="color:#f92672">...</span>: sig <span style="color:#f92672">=</span> inspect<span style="color:#f92672">.</span>signature(add)
    <span style="color:#f92672">...</span>: params <span style="color:#f92672">=</span> sig<span style="color:#f92672">.</span>parameters
    <span style="color:#f92672">...</span>: <span style="color:#66d9ef">print</span>(params)
OrderedDict([(<span style="color:#e6db74">&#39;x&#39;</span>, <span style="color:#f92672">&lt;</span>Parameter <span style="color:#e6db74">&#34;x:int&#34;</span><span style="color:#f92672">&gt;</span>), (<span style="color:#e6db74">&#39;y&#39;</span>, <span style="color:#f92672">&lt;</span>Parameter <span style="color:#e6db74">&#34;y:int&#34;</span><span style="color:#f92672">&gt;</span>)])

In [<span style="color:#ae81ff">21</span>]: params[<span style="color:#e6db74">&#39;x&#39;</span>]<span style="color:#f92672">.</span>annotation
Out[<span style="color:#ae81ff">21</span>]: int    <span style="color:#75715e"># 如果没有定义x的参数注解，那么这里就是inspect._empty</span>
</code></pre></div><p>通过它的属性，搭配<code>有序字典</code>这个特性,有没有很兴奋？参数有序，传入的实参有序，还能获取参数注解的类型，那么就可以开工进行参数检查了！</p>
<h1 id="6-检查参数">6 检查参数</h1>
<p>以上面函数为例子，当给add函数传入的x，y时进行参数检查，如果x，y不是int类型，那么返回异常，并退出函数</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> inspect
<span style="color:#f92672">import</span> functools

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check</span>(fn):
    <span style="color:#a6e22e">@functools.wraps</span>(fn)   <span style="color:#75715e"># 等于 wrapper.__annotation__ = fn.__annotation__ 还有其他的属性比如__doc__，__module__等</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrapper</span>(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs):
        sig <span style="color:#f92672">=</span> inspect<span style="color:#f92672">.</span>signature(fn)   <span style="color:#75715e"># 获取add函数签名信息</span>
        params <span style="color:#f92672">=</span> sig<span style="color:#f92672">.</span>parameters     <span style="color:#75715e"># 获取add函数的参数信息</span>
        values <span style="color:#f92672">=</span> list(params<span style="color:#f92672">.</span>values())   <span style="color:#75715e"># 由于params是个有序字典，那么values也是有序的，只需根据索一一对应判断即可</span>
        <span style="color:#66d9ef">for</span> i, k <span style="color:#f92672">in</span> enumerate(args):   <span style="color:#75715e"># 遍历用户传入的位置参数</span>
            <span style="color:#66d9ef">if</span> values[i]<span style="color:#f92672">.</span>annotation <span style="color:#f92672">!=</span> inspect<span style="color:#f92672">.</span>_empty:   <span style="color:#75715e"># 如果定义了参数注解，则开始检查</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isinstance(k, values[i]<span style="color:#f92672">.</span>annotation):   <span style="color:#75715e"># 如果检查不通过，曝出异常</span>
                    <span style="color:#66d9ef">raise</span>(<span style="color:#e6db74">&#39;Key Error&#39;</span>)
        <span style="color:#66d9ef">for</span> k,v <span style="color:#f92672">in</span> kwargs<span style="color:#f92672">.</span>items():
            <span style="color:#66d9ef">if</span> params[k]<span style="color:#f92672">.</span>annotation <span style="color:#f92672">!=</span> inspect<span style="color:#f92672">.</span>_empty:
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isinstance(v,params[k]<span style="color:#f92672">.</span>annotation):
                    <span style="color:#66d9ef">raise</span>(<span style="color:#e6db74">&#39;Key Error&#39;</span>)
        <span style="color:#66d9ef">return</span> fn(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
    <span style="color:#66d9ef">return</span> wrapper

<span style="color:#a6e22e">@check</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(x: int, y: int) <span style="color:#f92672">-&gt;</span> int:
    <span style="color:#66d9ef">return</span> x <span style="color:#f92672">+</span> y
    
add(<span style="color:#ae81ff">4</span>,y<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</code></pre></div><p>{% endraw %}</p>

</div>


  
</article>
      <footer id="main-footer" class="container main_footer">
  

  <div class="container nav foot no-print">
  
<a href="https://dachenzi.github.io/license">license</a>


  <a class="toplink" href="#">back to top</a>

</div>

  <div class="container credits">
  
<div class="container footline">
  
  code with <!-- raw HTML omitted --><!-- raw HTML omitted -->


</div>


  
<div class="container copyright">
  
  (c) 2015 Lee xin.


</div>


</div>

</footer>

    </main>
    
<script type="text/javascript">
  (function() {
    
    
    if (window.location.hostname == "localhost")
      return;
    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//your_disqus_shortname.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



    
  </body>
</html>

