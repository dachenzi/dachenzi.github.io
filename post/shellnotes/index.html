<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>ShellNotes - daxin.li&#39;s blog</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="daxin.li" />
  <meta name="description" content="1 什么是shell shell是一个命令解释器，位于操作系统的最外层，它负责和用户直接对话，不用户输入的内容解释给操作系统，操作系统处理完毕后" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.75.1" />


<link rel="canonical" href="https://dachenzi.github.io/post/shellnotes/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.b3a8813c06e6d785beba22bf8264e174fa2cb3a396b22f9ba24e2c00c18aaf7f.css" integrity="sha256-s6iBPAbm14W&#43;uiK/gmThdPoss6OWsi&#43;bok4sAMGKr38=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="ShellNotes" />
<meta property="og:description" content="1 什么是shell shell是一个命令解释器，位于操作系统的最外层，它负责和用户直接对话，不用户输入的内容解释给操作系统，操作系统处理完毕后" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dachenzi.github.io/post/shellnotes/" />
<meta property="article:published_time" content="2016-12-26T10:16:58+00:00" />
<meta property="article:modified_time" content="2016-12-26T10:16:58+00:00" />
<meta itemprop="name" content="ShellNotes">
<meta itemprop="description" content="1 什么是shell shell是一个命令解释器，位于操作系统的最外层，它负责和用户直接对话，不用户输入的内容解释给操作系统，操作系统处理完毕后">
<meta itemprop="datePublished" content="2016-12-26T10:16:58+00:00" />
<meta itemprop="dateModified" content="2016-12-26T10:16:58+00:00" />
<meta itemprop="wordCount" content="34100">



<meta itemprop="keywords" content="content_a," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ShellNotes"/>
<meta name="twitter:description" content="1 什么是shell shell是一个命令解释器，位于操作系统的最外层，它负责和用户直接对话，不用户输入的内容解释给操作系统，操作系统处理完毕后"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">daxin.li's blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://dachenzi.github.io/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://dachenzi.github.io/post/">文章</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://dachenzi.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://dachenzi.github.io/categories/">类别</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://gohugo.io" rel="noopener" target="_blank">
              关于
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      daxin.li's blog
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://dachenzi.github.io/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://dachenzi.github.io/post/">文章</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://dachenzi.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://dachenzi.github.io/categories/">类别</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://gohugo.io" rel="noopener" target="_blank">
              关于
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">ShellNotes</h1>
      
      <div class="post-meta">
        <time datetime="2016-12-26" class="post-time">
          2016-12-26
        </time>
        <div class="post-category">
            <a href="https://dachenzi.github.io/categories/content_a/"> content_a </a>
            
          </div>
        <span class="more-meta"> 约 34100 字 </span>
          <span class="more-meta"> 预计阅读 69 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#21-如何写一个思路缜密的shell脚本">2.1 如何写一个思路缜密的shell脚本</a></li>
    <li><a href="#22-shell的特点">2.2 shell的特点</a></li>
    <li><a href="#23-shell的分类">2.3 shell的分类</a></li>
    <li><a href="#24-其他脚本语言">2.4 其他脚本语言</a></li>
    <li><a href="#25-常用系统的默认shell">2.5 常用系统的默认shell</a></li>
    <li><a href="#26-修改用户默认的shell">2.6 修改用户默认的shell</a></li>
    <li><a href="#27-shell脚本的建立">2.7 shell脚本的建立</a></li>
    <li><a href="#28-shell脚本的执行">2.8 shell脚本的执行</a></li>
  </ul>

  <ul>
    <li><a href="#41-什么是变量">4.1 什么是变量</a></li>
    <li><a href="#42-shell的变量特性">4.2 shell的变量特性</a>
      <ul>
        <li><a href="#421-变量的类型">4.2.1 变量的类型</a></li>
        <li><a href="#422-环境变量">4.2.2 环境变量</a></li>
        <li><a href="#424-shell的特殊重要变量">4.2.4 shell的特殊重要变量</a></li>
        <li><a href="#4244-变量子串">4.2.4.4 变量子串</a></li>
        <li><a href="#423-变量的输入">4.2.3 变量的输入</a></li>
      </ul>
    </li>
    <li><a href="#43-条件测试与比较">4.3 条件测试与比较</a>
      <ul>
        <li><a href="#431-条件测试表达式">4.3.1 条件测试表达式</a></li>
        <li><a href="#432-文件测试表达式">4.3.2 文件测试表达式</a></li>
        <li><a href="#433-字符串测试表达式">4.3.3 字符串测试表达式</a></li>
        <li><a href="#434-整数测试表达式">4.3.4 整数测试表达式</a></li>
        <li><a href="#435-逻辑操作符">4.3.5 逻辑操作符</a></li>
        <li><a href="#436-shell实例">4.3.6 shell实例</a></li>
      </ul>
    </li>
    <li><a href="#44-分支与循环结构">4.4 分支与循环结构</a>
      <ul>
        <li><a href="#441-if条件语句">4.4.1 if条件语句</a></li>
        <li><a href="#442-case结构条件句">4.4.2 case结构条件句</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#51-当型循环和直到循环">5.1 当型循环和直到循环</a></li>
    <li><a href="#52-sleep休息命令">5.2 sleep休息命令</a></li>
    <li><a href="#53-前后台运行">5.3 前后台运行</a></li>
    <li><a href="#54-while循环">5.4 while循环</a>
      <ul>
        <li><a href="#541-while循环读文件">5.4.1 while循环读文件</a></li>
        <li><a href="#542-while循环小结">5.4.2 while循环小结</a></li>
      </ul>
    </li>
    <li><a href="#55-for循环">5.5 for循环</a></li>
    <li><a href="#56-循环控制">5.6 循环控制</a></li>
  </ul>

  <ul>
    <li><a href="#61-为什么要使用shell函数">6.1 为什么要使用shell函数</a></li>
    <li><a href="#62-shell函数语法">6.2 shell函数语法</a></li>
    <li><a href="#63-shell的函数执行">6.3 shell的函数执行</a>
      <ul>
        <li><a href="#631-shell脚本字体颜色">6.3.1 shell脚本字体颜色</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#71-数组的定义">7.1 数组的定义</a></li>
    <li><a href="#72-向数组的添加值">7.2 向数组的添加值</a></li>
    <li><a href="#75-小结">7.5 小结</a></li>
    <li><a href="#mathjax-true">title: ShellNotes
date: 2016-01-25 06:00:58
lastmod: 2016-01-25 06:00:58
draft: false
tags: [Shell,]
categories: [Shell,]
author: &ldquo;daxin.li&rdquo;
comment: true
toc: true
reward: true
mathjax: true</a></li>
  </ul>

  <ul>
    <li><a href="#21-如何写一个思路缜密的shell脚本-1">2.1 如何写一个思路缜密的shell脚本</a></li>
    <li><a href="#22-shell的特点-1">2.2 shell的特点</a></li>
    <li><a href="#23-shell的分类-1">2.3 shell的分类</a></li>
    <li><a href="#24-其他脚本语言-1">2.4 其他脚本语言</a></li>
    <li><a href="#25-常用系统的默认shell-1">2.5 常用系统的默认shell</a></li>
    <li><a href="#26-修改用户默认的shell-1">2.6 修改用户默认的shell</a></li>
    <li><a href="#27-shell脚本的建立-1">2.7 shell脚本的建立</a></li>
    <li><a href="#28-shell脚本的执行-1">2.8 shell脚本的执行</a></li>
  </ul>

  <ul>
    <li><a href="#41-什么是变量-1">4.1 什么是变量</a></li>
    <li><a href="#42-shell的变量特性-1">4.2 shell的变量特性</a>
      <ul>
        <li><a href="#421-变量的类型-1">4.2.1 变量的类型</a></li>
        <li><a href="#422-环境变量-1">4.2.2 环境变量</a></li>
        <li><a href="#424-shell的特殊重要变量-1">4.2.4 shell的特殊重要变量</a></li>
        <li><a href="#4244-变量子串-1">4.2.4.4 变量子串</a></li>
        <li><a href="#423-变量的输入-1">4.2.3 变量的输入</a></li>
      </ul>
    </li>
    <li><a href="#43-条件测试与比较-1">4.3 条件测试与比较</a>
      <ul>
        <li><a href="#431-条件测试表达式-1">4.3.1 条件测试表达式</a></li>
        <li><a href="#432-文件测试表达式-1">4.3.2 文件测试表达式</a></li>
        <li><a href="#433-字符串测试表达式-1">4.3.3 字符串测试表达式</a></li>
        <li><a href="#434-整数测试表达式-1">4.3.4 整数测试表达式</a></li>
        <li><a href="#435-逻辑操作符-1">4.3.5 逻辑操作符</a></li>
        <li><a href="#436-shell实例-1">4.3.6 shell实例</a></li>
      </ul>
    </li>
    <li><a href="#44-分支与循环结构-1">4.4 分支与循环结构</a>
      <ul>
        <li><a href="#441-if条件语句-1">4.4.1 if条件语句</a></li>
        <li><a href="#442-case结构条件句-1">4.4.2 case结构条件句</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#51-当型循环和直到循环-1">5.1 当型循环和直到循环</a></li>
    <li><a href="#52-sleep休息命令-1">5.2 sleep休息命令</a></li>
    <li><a href="#53-前后台运行-1">5.3 前后台运行</a></li>
    <li><a href="#54-while循环-1">5.4 while循环</a>
      <ul>
        <li><a href="#541-while循环读文件-1">5.4.1 while循环读文件</a></li>
        <li><a href="#542-while循环小结-1">5.4.2 while循环小结</a></li>
      </ul>
    </li>
    <li><a href="#55-for循环-1">5.5 for循环</a></li>
    <li><a href="#56-循环控制-1">5.6 循环控制</a></li>
  </ul>

  <ul>
    <li><a href="#61-为什么要使用shell函数-1">6.1 为什么要使用shell函数</a></li>
    <li><a href="#62-shell函数语法-1">6.2 shell函数语法</a></li>
    <li><a href="#63-shell的函数执行-1">6.3 shell的函数执行</a>
      <ul>
        <li><a href="#631-shell脚本字体颜色-1">6.3.1 shell脚本字体颜色</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#71-数组的定义-1">7.1 数组的定义</a></li>
    <li><a href="#72-向数组的添加值-1">7.2 向数组的添加值</a></li>
    <li><a href="#75-小结-1">7.5 小结</a></li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <h1 id="1-什么是shell">1 什么是shell</h1>
<p>        shell是一个命令解释器，位于操作系统的最外层，它负责和用户直接对话，不用户输入的内容解释给操作系统，操作系统处理完毕后，输出结果，输出到屏幕上。分为交互式的和非交互式的。输入命令，得到结果。就是交互式的，执行脚本就是非交互的。
<strong>总结：shell就像是一座桥梁，连通用户和操作系统。</strong></p>
<h1 id="2-什么是shell脚本">2 什么是shell脚本</h1>
<p>        把一个或多个linux命令组合起来放在一个程序文件中执行，这样的程序叫做shell脚本。严格来说把命令.变量和流程控制语句等结合在一起，就是shell脚本</p>
<h2 id="21-如何写一个思路缜密的shell脚本">2.1 如何写一个思路缜密的shell脚本</h2>
<p>        要多去模拟操作，多去想想为什么</p>
<h2 id="22-shell的特点">2.2 shell的特点</h2>
<p>        linux中所有的配置文件.日志文件都是纯文本文件。而shell的特点就是善于处理纯文本的内容。</p>
<h2 id="23-shell的分类">2.3 shell的分类</h2>
<p>        bourne shell(包括 sh,ksh,bash) C shell(csh,tcsh)<br>
        查看系统支持的sh类型：/etc/shells,常用的就是/bin/sh,/bin/bash,/sbin/nologin<br>
        Linux主流的shell就是bash，它是bourne again shell的缩写，是由bonrne shell发展而来，它还包含了csh和ksh的特色。<br>
        <strong>目前：通用的bourne shell 已经被bash shell取代</strong></p>
<h2 id="24-其他脚本语言">2.4 其他脚本语言</h2>
<ol>
<li>php：主要用于web页面开发，适合wab前端展示</li>
<li>perl：比shell强大，语法灵活，实现方式很多，不易读，其中mysql的HA就是由perl写的</li>
<li>python：近几年很火的软件，不但可以开发前端，也可以开发后端，属于全能型语言</li>
</ol>
<h2 id="25-常用系统的默认shell">2.5 常用系统的默认shell</h2>
<p>        Linux：bash<br>
        solaris：bonrne sh<br>
        AIX：ksh<br>
        HP-unix：posix shell（sh）</p>
<h2 id="26-修改用户默认的shell">2.6 修改用户默认的shell</h2>
<p>        可以修改/etc/default/useradd文件的shell字段，更改新添加的用户。也可以直接修改/etc/passwd中的最后一个字段，直接修改某个用户的shell。</p>
<h2 id="27-shell脚本的建立">2.7 shell脚本的建立</h2>
<p>        <strong>通过vim编辑器编写shell脚本</strong> ,注意脚本的第一行 <strong>#!/bin/bash</strong> 表示来指定解释器</p>
<blockquote>
<p>注意：python 程序开头 #!/usr/bin/env python因为Linux默认就是使用bash，所以使用bash的话，可以不用加，为了规范还是要添加。如果不指定解释器，就需要用bash test.sh来执行了。<br>
注意：写脚本要写注释</p>
</blockquote>
<h2 id="28-shell脚本的执行">2.8 shell脚本的执行</h2>
<p>        当shell运行时，它会先查找系统环境变量ENV，该变量指定了环境文件（通常是.bashrc,.bash_profile,/etc/bashrc,/etc/profile等），然后从该环境变量文件开始执行脚本，当读取了ENV的文件后，shell会开始执行shell脚本中的内容。<br>
注意：设置cron任务时，最好把系统变量在脚本中重新定义一遍
<strong>shell脚本的执行通常采用以下几种方式</strong></p>
<ol>
<li>bash scripts-name 或 sh scripts-names （推荐）</li>
<li>patch/scripts-name 或 ./scripts-names （需要脚本有执行权限）</li>
<li>source scripts-name 或　. scripts-names （执行脚本的同时，使父shell继承子shell的变量)</li>
<li>sh&lt;scripts-name 或　cat scripts-name|sh</li>
</ol>
<blockquote>
<p>注意：我们用户登录的时候会默认分配一个shell，这个shell就是父shell，而在这个shell中执行的shell脚本，就属于子shell，父shell是不能直接继承子shell的变量的，但子shell可以直接继承父shell的变量，如果想要父shell获取子shell中的变量，就需要使用source或者.来执行脚本了。（相当于php中的include）</p>
</blockquote>
<h1 id="3-shell脚本开发基本规范">3 shell脚本开发基本规范</h1>
<ol>
<li>脚本第一行指定解释器</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash或者#!/bin/sh
</span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>脚本开头加版权信息</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#Date:</span>
<span class="c1">#Author: create by lixin</span>
<span class="c1">#Mail：</span>
<span class="c1">#Function:功能</span>
</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>脚本中不用中文注释</li>
<li>脚本使用.sh作为扩展名</li>
<li>写代码优秀习惯
<ul>
<li>成对的符号尽量一次打出来，防止遗漏</li>
</ul>
<ul>
<li>[ a ]中括号两端要有空格，书写的时候就街上，[[ a ]]双中括号也是如此。</li>
<li>流程控制语句一次书写完，在添加内容</li>
</ul>
</li>
</ol>
<h1 id="4-shell变量基础及深入">4 shell变量基础及深入</h1>
<h2 id="41-什么是变量">4.1 什么是变量</h2>
<p>        比如x=1,y=x+1,那么y等于2。x和y就是变量名，x变量的值是1，而y变量的值是x+1，等号在这里叫做赋值。
简单的说，变量就是用一个固定的字符串（也可能是字符数字等的组合），代替更多更复杂的内容，这个内容里可能还会包含变量.路径.字符串等其他的内容。
<strong>变量是暂时存数据的地方，这个存储的数据是存在于内存空间中的，通过调用变量的名字就可以取出变量对应的数据。</strong></p>
<h2 id="42-shell的变量特性">4.2 shell的变量特性</h2>
<p>        bash shell中默认的情况下是不会区分变量的内容的类型，例如：整数.字符串.小数等。这一点和其他强类型语言是有区别的。如果需要指定shell变量内容类型，可以使用declare显示指定定义变量的类型（没这个需求）。</p>
<h3 id="421-变量的类型">4.2.1 变量的类型</h3>
<p>        变量可以分为：环境变量（全局变量）和普通变量（局部变量）。<br>
        环境变量也成为全局变量，可以在创建他们的shell及其派生出来的任意子进程shell中使用，环境变量又可以分为自定义环境变量和bash内置的环境变量。<br>
        普通变量也可成为局部变量，只能在创建他们的shll函数或shell脚本中使用。普通变量一般是由开发者在开发脚本程序时创建的。</p>
<h3 id="422-环境变量">4.2.2 环境变量</h3>
<p>        环境变量一般用于定义shell的运行环境，保证shell命令的正确执行，shell通过环境变量来确定登录用户名.命令路径.终端类型.登录目录的等，所有的环境变量都是系统全局变量，可用于所有子进程中，这包括编辑器.shell脚本和各类应用（cron任务比较特殊需要注意）。<br>
        环境变量可以在命令行中设置创建，但用户退出命令是这些变量值就会丢失，因此，如果希望永久保存环境变量，可以在用户家目录下.bash_profile或.bashrc文件或全部配置文件/etc/profile或/etc/bashrc文件或者/etc/profile.d/下定义，因为每次用户登录时这些变量的值都会被初始化一次。<br>
        所有环境变量名字格式均为大写，环境变量用于用户进程程序前，都应该用export命令导出定义，例如：export KEY=1.<br>
        环境变量可以在创建他们的shell和从该shell派生的任意子shell或进程中，他们通常被称为全局变量以区别局部变量。通常，环境变量应该大写。环境变量是已经用export内置命令导出的变量。<br>
        有一些环境变量，比如HMOE.PATH.SHELL.UID.USER等，在用户登录之前就已经被/bin/login程序设置好了，通常环境变量定义并保存在用户家目录下的.bash_profile中。</p>
<h4 id="4221-定义全局变量格式">4.2.2.1 定义全局变量格式</h4>
<ol>
<li>export 变量名=value；</li>
<li>变量名=value；export 变量名</li>
<li>declare -x 变量名=value<br>
<strong>注意：如果是java环境，最后再脚本里面再定义一遍java环境变量。</strong></li>
</ol>
<h4 id="4222-显示与取消环境变量">4.2.2.2 显示与取消环境变量</h4>
<p>        通过echo或printf命令打印环境变量
例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">打印用户登录的目录: <span class="nb">echo</span> <span class="nv">$HOME</span>
打印用户的UID: <span class="nb">printf</span> <span class="nv">$UID</span>
使用env和set命令查看所有的环境变量
通过unset命令取消环境变量: <span class="nb">unset</span> NAME
</code></pre></td></tr></table>
</div>
</div><h4 id="4223-环境变量小结">4.2.2.3 环境变量小结</h4>
<ol>
<li>变量名通常要大写</li>
<li>可以在自身的shell以及子shell中使用</li>
<li>通过export来定义</li>
<li>查看使用echo $NAME</li>
<li>删除使用unset NAME</li>
<li>永久生效写入到用户环境变量文件，或者全局环境变量文件中。</li>
<li>写定时任务的时候，注意在脚本中添加环境变量（java）。</li>
</ol>
<h4 id="423-普通变量">4.2.3 普通变量</h4>
<p>        本地变量再用户当前的shell生存期的脚本中使用，例如，本地变量key的取值为123，这个值只在用户当前shell生存期中有意义。如果在shell中启动另一个进程或退出，本地变量key值将无效。</p>
<h4 id="4231-定义普通变量">4.2.3.1 定义普通变量</h4>
<p>定义普通变量的方法：</p>
<ol>
<li>变量名=value</li>
<li>变量名=&lsquo;value&rsquo;</li>
<li>变量名=&ldquo;value&rdquo;</li>
</ol>
<blockquote>
<p>其中，变量名一般是有字符，数字，下划线组成。可以字符或下划线开头，但是不能以数字开头。<br>
变量的内容，可以用单引号或双引号引起来，或不加引号。三者的区别是；不加引号，不能输入不连续的值，只要变量连续，可以解释其中引用的其他变量。单引号和echo中的单引号相同，就是内部有变量则不会解释变量，双引号即如果定义的值中引用其他变量，则解释该变量，变量的值可以是不连续的。而反引号，一般用来解析命令，相当于$().</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">例子：
 <span class="nv">a</span><span class="o">=</span>192.168.1.2
 <span class="nv">b</span><span class="o">=</span><span class="s1">&#39;192.168.1.2-$a&#39;</span>
 <span class="nv">c</span><span class="o">=</span><span class="s2">&#34;192.168.1.2-</span><span class="nv">$a</span><span class="s2">&#34;</span>
 <span class="nb">echo</span> <span class="nv">$a</span>
 192.168.1.2
<span class="nb">echo</span> <span class="nv">$b</span>
       192.168.1.2-<span class="nv">$a</span>
<span class="nb">echo</span> <span class="nv">$c</span>
 192.168.1.2-192.168.1.2

<span class="nv">a</span><span class="o">=</span>192.168.1.2-<span class="nv">$a</span>
<span class="nv">b</span><span class="o">=</span><span class="s1">&#39;192.168.1.2-$a&#39;</span>
<span class="nv">c</span><span class="o">=</span><span class="s2">&#34;192.168.1.2-</span><span class="nv">$a</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="nv">$a</span>
       192.168.1.2-192.168.1.2
<span class="nb">echo</span> <span class="nv">$b</span>
       192.168.1.2-<span class="nv">$a</span>
<span class="nb">echo</span> <span class="nv">$c</span>
       192.168.1.2-192.168.1.2-192.168.1.2
注意：日常定义变量如果是纯数字的话可以不加引号，其他情况建议都使用双引号。
扩展：把命令的结果作为变量
<span class="nv">变量名</span><span class="o">=</span><span class="sb">`</span>ls<span class="sb">`</span>或者 <span class="nv">变量名</span><span class="o">=</span><span class="k">$(</span>ls<span class="k">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4232-普通变量小结">4.2.3.2 普通变量小结</h4>
<ol>
<li>连续的数字字符串可以不加引号</li>
<li>变量内容是命令的结果，定义时可以使用反引号或$().</li>
<li>若变量和其他字符连接的时候，就必须给变量加上大括号{}。_<em>${key}<em>keyname;</em></em></li>
</ol>
<h4 id="4233-变量的高级应用">4.2.3.3 变量的高级应用</h4>
<p>定义变量后可以直接在各个地方调用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">key</span><span class="o">=</span>init
grep <span class="nv">$key</span> /etc/iniitab
grep <span class="s2">&#34;</span><span class="nv">$key</span><span class="s2">&#34;</span> /etc/inittab
<span class="c1"># 上面两个会过滤出/etc/inittab中包含init字符串的行</span>
grep <span class="s1">&#39;$key&#39;</span> /etc/inittab
<span class="c1"># 单引号，则会过滤出/etc/inittab中包含$key的行,同样适用于sed。</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>注意：awk中不同于grep和sed中</strong><br>
awk中的特殊用法1：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-awk" data-lang="awk"><span class="nx">key</span><span class="o">=</span><span class="nx">init</span>
<span class="nx">awk</span> <span class="s1">&#39;BEGIN{print &#34;$key&#34;}&#39;</span>
<span class="c1"># awk中&#34;&#34;是不解释变量的，和常规的相反，只有使用单引号才会解析。</span>
<span class="nx">awk</span> <span class="s1">&#39;BEGIN{print &#39;</span><span class="o">$</span><span class="nx">key</span><span class="s1">&#39;}&#39;</span>
<span class="c1"># 不加引号，则不会输出</span>
</code></pre></td></tr></table>
</div>
</div><p>awk中的特殊用法2：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-awk" data-lang="awk"><span class="nx">key</span><span class="o">=</span><span class="s1">&#39;int&#39;</span>
<span class="nx">awk</span> <span class="s1">&#39;BEGIN{print &#39;</span><span class="o">$</span><span class="nx">key</span><span class="s1">&#39;}&#39;</span>
<span class="c1"># 这时也是不会输出内容的，需要在单引号外面再加一层双引号才可以</span>
<span class="nx">awk</span> <span class="s1">&#39;BEGIN{print &#34;&#39;</span><span class="o">$</span><span class="nx">key</span><span class="s1">&#39;&#34;}&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="424-shell的特殊重要变量">4.2.4 shell的特殊重要变量</h3>
<h4 id="4241-位置变量">4.2.4.1 位置变量</h4>
<p>        <strong>$0</strong> 获取当前执行的shell脚本，如果执行脚本带路径那么就包括脚本路径。<br>
        <strong>$n</strong> 获取当前执行的shell脚本的第n个参数的值，n=1..9，当n为0时表示脚本的文件名，如果n大于9，用大括号括起来${10}.例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 创建测试文件：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo -n &#39;echo &#39; &gt; test1.sh &amp;&amp; echo \${1..15} &gt;&gt; test.sh</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test.sh</span>
<span class="nb">echo</span> <span class="nv">$1</span> <span class="nv">$2</span> <span class="nv">$3</span> <span class="nv">$4</span> <span class="nv">$5</span> <span class="nv">$6</span> <span class="nv">$7</span> <span class="nv">$8</span> <span class="nv">$9</span> <span class="nv">$10</span> <span class="nv">$11</span> <span class="nv">$12</span> <span class="nv">$13</span> <span class="nv">$14</span> <span class="nv">$15</span> <span class="nv">$16</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># bash test.sh {a..z}</span>
a b c d e f g h i a0 a1 a2 a3 a4 a5 a6
<span class="c1"># 由于变量超过了9个，所以从第10个变量开始要加大括号，不然shell认为$10，是$1的值和0组合在一起，所以才会显示a0</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test.sh</span>
<span class="nb">echo</span> <span class="nv">$1</span> <span class="nv">$2</span> <span class="nv">$3</span> <span class="nv">$4</span> <span class="nv">$5</span> <span class="nv">$6</span> <span class="nv">$7</span> <span class="nv">$8</span> <span class="nv">$9</span> <span class="si">${</span><span class="nv">10</span><span class="si">}</span> <span class="si">${</span><span class="nv">11</span><span class="si">}</span> <span class="si">${</span><span class="nv">12</span><span class="si">}</span> <span class="si">${</span><span class="nv">13</span><span class="si">}</span> <span class="si">${</span><span class="nv">14</span><span class="si">}</span> <span class="si">${</span><span class="nv">15</span><span class="si">}</span> <span class="si">${</span><span class="nv">16</span><span class="si">}</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># bash test.sh {a..z}</span>
a b c d e f g h i j k l m n o p
<span class="c1"># $# 表示脚本传参的个数，脚本名称后面的参数的个数.</span>
<span class="c1"># $* 将命令行脚本所有参数视为单个字符串等同于&#34;$1$2$3&#34;,$*要用双引号。</span>
<span class="c1"># $@ 将命令行脚本每个参数视为单独的字符串，等同于&#34;$1&#34;,&#34;$2&#34;,&#34;$3&#34;,这是将参数传递给其他程序的最佳方式，因为他会保留所有内嵌在每个参数里的任何空白。</span>
<span class="c1"># 注意：上述区别仅限于添加双引号的时候，即&#34;$*&#34;和$&#34;@&#34;</span>
例：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># set -- a b c</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># for i in &#34;$@&#34; ;do echo $i; done;</span>
a
b
c
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># for i in &#34;$*&#34; ;do echo $i; done;</span>
a b c
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4242-进程状态变量">4.2.4.2 进程状态变量</h4>
<p>        $? 查看上一个命令的执行结果。0表示成功，非0表示不成功。</p>
<blockquote>
<p>错误代码返回值参考：<br>
2：权限不够<br>
1-125:表示运行失败（脚本命令.系统命令错误或参数传递错误）<br>
126：找到该命令了，但无法执行<br>
127：命令找不到<br>
128:被强制中断了 <br>
注意：在shell脚本中一般用exit 数字，来把返回值传递给$?
如果是函数，则通过return 数字，返回返回值给$?<br>
扩展：通过set命令进传参<br>
<a href="http://httpd.blog.51cto.com/2561410/1175971">http://httpd.blog.51cto.com/2561410/1175971</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">set</span> -- <span class="s1">&#39;i am&#39;</span> handsome boy 传递3个参数到shell
<span class="nb">set</span> -- <span class="m">1</span> <span class="m">2</span> <span class="m">3</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo $1 $2 $3</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span>
<span class="c1"># $$ 显示当前进程的进程号</span>
<span class="c1"># $! 上一个进程的id号</span>
cat pid.sh
<span class="nb">echo</span> <span class="nv">$$</span> &gt;/tmp/a.pid
sleep <span class="m">300</span>

sh pid.sh <span class="p">&amp;</span>
cat /tmp/a.pid
</code></pre></td></tr></table>
</div>
</div><h4 id="4243-bash内置命令">4.2.4.3 bash内置命令</h4>
<p>        bash的内置命令，这些命令内置在bash中，没有绝对路径，需要时可以直接在shell脚本中调用 <strong>alias, bg, bind, break, builtin, caller, cd,command, compgen, complete, compopt, continue, declare, dirs,disown,  echo,  enable,  eval, exec, exit, export, false, fc,fg, getopts, hash, help, history,  jobs,  kill,  let,  local,logout,  mapfile,  popd,  printf, pushd, pwd, read, readonly,return, set, shift,  shopt,  source,  suspend,  test,  times,trap,  true,  type,  typeset,  ulimit, umask, unalias, unset,wait</strong></p>
<h3 id="4244-变量子串">4.2.4.4 变量子串</h3>
<p>        通过man bash找到Parameter Expansion来查看子串的全部用法<br>
        ${#变量名}取变量的长度</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># httpd=&#34;I am httpd&#34;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo $httpd</span>
I am httpd
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo $httpd|wc -L</span>
<span class="m">11</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${#httpd}</span>
<span class="m">11</span>
</code></pre></td></tr></table>
</div>
</div><p>        通过使用expr命令计算变量的长度</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># expr length &#34;$httpd&#34;</span>
<span class="m">11</span>

<span class="c1"># 计算I am good boy,welcome to myhome中字母小于5个的并打印</span>
<span class="k">for</span> i in I am good boy,welcome to myhome
<span class="k">do</span>
<span class="o">[</span> <span class="si">${#</span><span class="nv">i</span><span class="si">}</span> -lt <span class="m">5</span> <span class="o">]</span> <span class="o">&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$i</span><span class="s2">&#34;</span>
<span class="o">}</span>
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>        ${变量：2}截取变量的第几个字符到最后</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># httpd=&#34;I am httpd&#34;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${httpd:2}</span>
am httpd
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${httpd:3}</span>
m httpd
</code></pre></td></tr></table>
</div>
</div><p>        ${#变量:n:m}从第n个字符开始截取m个</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${httpd:2:2}</span>
am
</code></pre></td></tr></table>
</div>
</div><p>        ${变量#字符串}从开头开始匹配，删除最短匹配字符串的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
<span class="m">123123123123123123123123456</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN#1*3}</span>
<span class="m">123123123123123123123456</span>
</code></pre></td></tr></table>
</div>
</div><p>        ${变量##字符串}从开头开始匹配，删除最长匹配字符串的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN##1*3}</span>
<span class="m">456</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
i am good boy boy
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN%b*y}</span>
i am good boy
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN%%b*y}</span>
i am good
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>小结：</p>
<ol>
<li>#是开头删除匹配最短</li>
<li>##是开头删除匹配最长</li>
<li>%是结尾删除匹配最短</li>
<li>%%是结尾删除匹配最长</li>
</ol>
</blockquote>
<p>        ${变量/字符串1/字符串2}，从开头开始，把变量中的字符串1替换为字符串2.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=&#34;i am good boy boy&#34;</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
i am good boy boy
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN/boy/girl}</span>
i am good girl boy
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN//boy/girl}</span>
i am good girl girl
两个斜线表示替换所有符合的字符串
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN/#boy/girl}</span>
i am good boy boy
<span class="c1">#表示以boy开头的，替换为girl，由于变量LIXIN没有以boy开头，所以不会替换</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN/%boy/girl}</span>
i am good boy girl
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4245-变量替换">4.2.4.5 变量替换</h4>
<p><strong>${values:-word}</strong> 如果变量名称存在并且非null，则返回变量的值。否则返回word字符串，表示如果变量未定义，则返回默认值。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${lixin:-test}</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># lixin=123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${lixin:-test}</span>
<span class="m">123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $lixin</span>
空
</code></pre></td></tr></table>
</div>
</div><p><strong>${value:=word}</strong> 如果变量名存在且非null，则返回变量值。否则，设置这个变量为word，并返回其值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${lixin:=test}</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $lixin</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意：-和=的区别是，-表示变量为空的时候返回的默认值，这个默认值并不会被赋予变量，所以echo变量的时候依旧为空，=表示如果变量为空，则把word赋予该变量。<br>
扩展：这个冒号：也可以不加，功能和加上是相同的</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># unset LIXIN</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN-test}</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN-test}</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># unset LIXIN</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN=test}</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4246-变量的数值整数计算">4.2.4.6 变量的数值(整数)计算</h4>
<p>变量的数值计算常见的有如下几个命令：<strong>(()),let,expr,bc(小数运算)，${}，其他都是整数。</strong><br>
常用运算符号：</p>
<ul>
<li>++，&ndash;：增加或减少，可以前置也可以放在末尾</li>
<li>+,-,*,/,%：分别对应加.减.乘，除，求余</li>
<li>&lt;,&lt;=,&gt;,&gt;=：分别对应小于，小于等于，大于，大于等于</li>
<li>==，!=：等于，不等于</li>
<li>&amp;&amp;：逻辑和，即command1 &amp;&amp; comand2 ，command1成功则执行command2。</li>
<li>||：逻辑或，即command1 || comand2，command1不成功则执行command2。</li>
<li>=，+=，-=，<em>=，/=，%=，赋值运算符，a+=1,表示a=a+1,a</em>=1,表示a=a*1。</li>
</ul>
<p><strong>1.(())用法</strong><br>
如果要执行简单的整数就算，只需要将特定的算数表达式用$(())括起来即可。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((1+2))</span>
<span class="m">3</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $(1+2)</span>
-bash: 1+2: <span class="nb">command</span> not found

<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># ((a=1+2**3-4%3))</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
+<span class="o">=</span>例子：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a+=1))</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a-=1))</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
n++例子：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a++))</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a--))</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
++n例子：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a--))</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((--a))</span>
<span class="m">7</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">7</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((++a))</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>小结: n++和++n的区别是，变量n在前，则表达式的值为n，然后n自增或自减，变量n在后，则表达式的值为自增自减后的n</p>
<p><strong>2.let命令（用于整数计算）</strong><br>
格式：let 赋值表达式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># i=2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># i=i+8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $i</span>
i+8
<span class="c1"># 因为定义了两次i，所以第二次会覆盖之前对于i的定义</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># i=2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># let i=i+8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $i</span>
<span class="m">10</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># let的效果和(())相同，但效率不如(())高，所以建议用双括号</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>3.expr</strong></p>
<ul>
<li><strong>计算(整数数字，并且要有空格)</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 1 + 2</span>
<span class="m">3</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 1+2</span>
1+2
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 注意：除号.乘号需要用反斜线转意</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 2 \* 2</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>判断是否为整数</strong><br>
由于expr不能计算非整数的表达式，可以通过expr的返回值确定传递的变量是否为整数。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 1 + a</span>
expr: non-numeric argument
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $?</span>
<span class="m">2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 1 + 1</span>
<span class="m">2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $?</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat ceshi.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">a</span><span class="o">=</span><span class="nv">$1</span>
expr <span class="nv">$a</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]||{</span>
 <span class="nb">echo</span> <span class="s2">&#34;please input number&#34;</span>
<span class="o">}</span>
<span class="c1"># 或者</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat ceshi1.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">a</span><span class="o">=</span><span class="nv">$1</span>
expr <span class="nv">$a</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;{</span>
 <span class="nb">echo</span> <span class="s2">&#34;please input number&#34;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>计算字符串的长度</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr length $LIXIN</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
其他计算变量长度的方法：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${#LIXIN}</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN|wc -L</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN | awk &#34;{print length $0}&#34;</span>
<span class="m">4</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>expr判断后缀名</strong><br>
通过expr对变量进行模式匹配,格式为:expr value : 关键字</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=test.pub</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr $LIXIN : &#34;.*\.pub&#34;</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=test.puv</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr $LIXIN : &#34;.*\.pub&#34;</span>
<span class="m">0</span>
<span class="c1"># 匹配为0，不匹配则非0</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>time命令</strong> 计算命令的运行时间（真实时间.内核时间.用户时间）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># time sh bianliang1.sh 1</span>

real 0m0.003s
user       0m0.001s
sys  0m0.000s
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 该命令可以对相同结果的命令进行压力测试，看哪个执行速度更快</span>
</code></pre></td></tr></table>
</div>
</div><p>小结：内置功能速度更快（${#value}计算速度最快）
<strong>bc命令</strong><br>
linux内置命令，同时也是一个计算器，直接输入bc，会进入计算器界面。并且bc支持小数(awk也支持小数)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 命令行：</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo 1+2|bc</span>
<span class="m">3</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo 2*2|bc</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 转换成二进制</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo &#34;obase=2;255&#34;|bc</span>
<span class="m">11111111</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 确定小数点后数字的个数</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo &#34;scale=2;10/3&#34;|bc</span>
3.33
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo &#34;scale=3;10/3&#34;|bc</span>
3.333
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># awk方法计算小数</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo &#34;1.5 2.3&#34;|awk &#39;{print ($1*$2)}&#39;</span>
3.45
<span class="c1"># 例题:</span>
<span class="c1"># 计算1+2+3+4+5+6+7+8+9+10的值，并且列出1+2+3+4+5+6+7+8+9+10=55的结果</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo `seq -s &#39;+&#39; 10`=`seq -s &#39;+&#39; 10|bc`</span>
1+2+3+4+5+6+7+8+9+10<span class="o">=</span><span class="m">55</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># a=`seq -s &#34;+&#34; 10` &amp;&amp; echo $a=`echo $a|bc`</span>
1+2+3+4+5+6+7+8+9+10<span class="o">=</span><span class="m">55</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>小结：常用的shell的数值运算方法为(())和let</p>
<h3 id="423-变量的输入">4.2.3 变量的输入</h3>
<p>shell变量除了可以直接复制或脚本传参外，还可以使用read命令从标准输入获得，read为bash内置命令，可以通过help read查看帮助<br>
<strong>格式：read [参数] [变量名]</strong><br>
常用参数: -p,设置提示时间。-t，设置等待时间，默认单位为秒</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># read -t 10 -p &#34;please input two number&#34;</span>
please input two number1 <span class="m">2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># read -t 10 -p &#34;please input two number&#34; a b</span>
please input two number1 <span class="m">2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo $a $b</span>
<span class="m">1</span> <span class="m">2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>在脚本中通过read命令进行传参</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim read.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input two number&#34;</span> a b
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">+</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">+</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">-</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">-</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">/</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">/</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">*</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">*</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
扩展：read的提示性信息，可以通过
<span class="nb">echo</span> -n <span class="s1">&#39;please input two number&#39;</span>
<span class="nb">read</span> a b
来获取
</code></pre></td></tr></table>
</div>
</div><p>扩展题目：使用read读入2个变量，计算他们的加减乘除结果，并且判断是否为2个变量，以及是否为整数，当第二个数为被除数的时候不能为0</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim read.sh</span>

<span class="c1">#!/bin/bash</span>
<span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input two number&#34;</span> a b
<span class="o">[</span> -z <span class="nv">$a</span>  <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;the First number is null,please input number&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>  --&gt;可以通过<span class="si">${#</span><span class="nv">value</span><span class="si">}</span>，如果返回值为0，表示变量为空
<span class="o">[</span> -z <span class="nv">$b</span>  <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;the Seconed number is null,please input number&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
expr <span class="nv">$a</span> + <span class="nv">$b</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="nv">result</span><span class="o">=</span><span class="nv">$?</span>
<span class="o">[</span> <span class="nv">$result</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;please input two number&#34;</span>
  <span class="nb">exit</span> <span class="m">3</span>
<span class="o">}</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">+</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">+</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">-</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">-</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">*</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">*</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="o">[</span> <span class="nv">$b</span> -eq  <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
 <span class="nb">echo</span> <span class="s2">&#34;The Seconed is &#34;</span><span class="nv">$b</span><span class="s2">&#34;,can not calc /&#34;</span>
 <span class="nb">exit</span> <span class="m">4</span>
<span class="o">}</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">/</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">/</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="43-条件测试与比较">4.3 条件测试与比较</h2>
<p>        在bash的各种流程控制结果中，通常要进行各种测试，然后根据测试结果珍惜ing不同的操作，有时也会通过与if等条件语句相结合，更方便的完成判断。</p>
<h3 id="431-条件测试表达式">4.3.1 条件测试表达式</h3>
<p>条件测试有三种语法形式：</p>
<ol>
<li><strong>test &lt;测试表达式&gt;</strong></li>
<li><strong>[&lt;测试表达式&gt;]</strong></li>
<li><strong>[[&lt;测试表达式&gt;]]</strong></li>
</ol>
<blockquote>
<p>说明：<br>
1.其中1和2是等价的，只是写法不同。<br>
2.在[[]]中可以使用通配符进行模式匹配。&amp;&amp;.||.&lt;.&gt;等操作符可以直接应用于[[]]中，但不能应用于[]中。<br>
3.对于整数的关系运算，也可以使用shell的算数运算符(())。</p>
</blockquote>
<h4 id="4311-test-测试表达式">4.3.1.1 test &lt;测试表达式&gt;</h4>
<p>格式为：<strong>test [option] 目标</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -f /etc/hosts &amp;&amp; echo 0 || echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -x /etc/hosts &amp;&amp; echo 0 || echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -x /server/scripts/pid.sh &amp;&amp; echo 0 || echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -d /etc/hosts &amp;&amp; echo 0 || echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -d /etc &amp;&amp; echo 0 || echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4312-表达式">4.3.1.2 [&lt;表达式&gt;]</h4>
<p><strong>格式为：[ 选项 目标 ]</strong><br>
多个条件使用-a（并且），-o（或），来链接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -f /etc/hosts ] &amp;&amp; echo 0||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -f /etc/hosts -a -f /etc ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">1</span>
<span class="c1"># 由于etc不是文件，所以表达式为假</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -d /etc/host ] &amp;&amp; echo 0||echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -d /etc/hosts -a -d /etc ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">1</span>
<span class="c1"># 由于hosts不是目录，所以表达式为假</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -x /etc/host ] &amp;&amp; echo 0||echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4313-表达式">4.3.1.3 [[&lt;表达式&gt;]]</h4>
<p><strong>格式为：[[ 选项 目标 ]]</strong><br>
多个条件使用&amp;&amp;（并且），||（或），来链接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [[ -f /etc/hosts ]] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [[ -f /etc/hosts -a /etc/services ]] &amp;&amp; echo 0 ||echo 1</span>
-bash: syntax error in conditional expression
-bash: syntax error near <span class="s1">&#39;-a&#39;</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [[ -f /etc/hosts &amp;&amp; /etc/services ]] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># [[]]与[]不同的是表示逻辑关系的时候，&amp;&amp;（-a），||（-o）。</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="432-文件测试表达式">4.3.2 文件测试表达式</h3>
<p>部分选项如下：</p>
<ul>
<li>-f FILE:当测试文件存在，并且是一个普通文件，表达式的值为真</li>
<li>-d FILE:当测试文件是目录，表达式为真</li>
<li>-s FILE:当测试文件存在，并且非空，表达式的值为真</li>
<li>-e FILE:当测试文件存在(只要存在)，表达式为真</li>
<li>F1 -nt F2: F1比F2新</li>
<li>F1 -ot F2：F1比F2旧</li>
<li>-x FILE:当测试文件对当前用户来说可执行，表达式为真</li>
<li>-a FILE:当测试文件存在，表达式为真</li>
<li>-b FILE:当测试文件为块设备，表达式为真</li>
<li>-c FILE:当测试文件为字符设备，表达式为真</li>
<li>-g FILE:当测试文件拥有set GID，表达式为真</li>
<li>-h FILE:当测试文件为硬链接文件，表达式为真</li>
<li>-L FILE:当测试文件为软链接文件，表达式为真</li>
<li>-k FILE:当测试文件拥有sticky biy，表达式为真</li>
<li>-p FILE:当测试文件为管道文件，表达式为真</li>
<li>-r FILE:当测试文件对当前用户来说可读，表达式为真</li>
<li>-S FILE:当测试文件为socket文件，表达式的值为真</li>
<li>-u FILE:当测试文件拥有set UID，表达式为真</li>
<li>-w FILE:当测试文件对当前用户来说可写，表达式为真　　　　</li>
</ul>
<p><strong>注：在选项前加！表示取反</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 例：高效的判断方法</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -f /etc/host ] || echo 123</span>
<span class="m">123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat tiaojiao.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="o">[</span> -f <span class="nv">$1</span> <span class="o">]</span> <span class="o">||</span> <span class="o">{</span>
  <span class="nb">echo</span> <span class="m">1</span>
  <span class="nb">echo</span> <span class="m">2</span>
  <span class="nb">echo</span> <span class="m">3</span>
<span class="o">}</span>
<span class="c1"># 判断$1是否是文件，不是得话输出1，2，3</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># sh tiaojian.sh /etc/host</span>
<span class="m">1</span>
<span class="m">2</span>
<span class="m">3</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="433-字符串测试表达式">4.3.3 字符串测试表达式</h3>
<ul>
<li>-z &ldquo;string&rdquo;:当字符串为空，表达式为真</li>
<li>-n &ldquo;string&rdquo;:当字符串不为空，表达式为真</li>
<li>&ldquo;string 1&rdquo; = &ldquo;string 2&rdquo;:当字符串1和字符串2相等，则表达式为真，=号可以用==代替</li>
<li>&ldquo;string 1&rdquo; != &ldquo;string 2&rdquo;:当字符串1不等于字符串2，表达式为真</li>
</ul>
<p>注意：</p>
<ol>
<li>字符串用双引号&quot;&quot;,引起来</li>
<li>等号两边要有空格</li>
</ol>
<h3 id="434-整数测试表达式">4.3.4 整数测试表达式</h3>
<p><strong>在[]和test中 在[[]]和(())中 含义</strong></p>
<ul>
<li>-eq =或== 等于</li>
<li>-ne != 不等于</li>
<li>-gt &gt; 大于</li>
<li>-lt &lt; 小于</li>
<li>-ge &gt;= 大于等于</li>
<li>-le &lt;= 小于等于</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 例：生产中一般使用[]和eq这样的搭配</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
<span class="m">2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ $LIXIN -ne 0 ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ $LIXIN -eq 2 ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ $LIXIN -eq 3 ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="435-逻辑操作符">4.3.5 逻辑操作符</h3>
<p><strong>在[]和test中 在(())和[[]]中 含义</strong></p>
<ul>
<li>-a &amp;&amp; 并且</li>
<li>-o || 或</li>
<li>！非</li>
</ul>
<h3 id="436-shell实例">4.3.6 shell实例</h3>
<h4 id="4361-比大小">4.3.6.1 比大小</h4>
<p>传参的方式比大小：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;USAGE:</span><span class="nv">$0</span><span class="s2"> avg1 avg2&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
expr <span class="nv">$1</span> + <span class="nv">$2</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -ne  <span class="m">0</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;please input num&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$1</span> -eq <span class="nv">$2</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">=</span><span class="nv">$2</span><span class="s2">&#34;</span>
  <span class="nb">exit</span> <span class="m">3</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$1</span> -gt <span class="nv">$2</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&gt;</span><span class="nv">$2</span><span class="s2">&#34;</span>
<span class="o">}||{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&lt;</span><span class="nv">$2</span><span class="s2">&#34;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>read方式比大小：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input num1&#34;</span> a
<span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input num2&#34;</span> b
<span class="o">[</span> -z <span class="nv">$a</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;error,please input number1&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
<span class="o">[</span> -z <span class="nv">$b</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;error,pleasr input number2&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
expr <span class="nv">$a</span> + <span class="nv">$b</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -ne  <span class="m">0</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;please input num&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$a</span> -eq <span class="nv">$b</span>  <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">=</span><span class="nv">$b</span><span class="s2">&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$a</span> -gt <span class="nv">$b</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&gt;</span><span class="nv">$b</span><span class="s2">&#34;</span>
<span class="o">}||{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&lt;</span><span class="nv">$b</span><span class="s2">&#34;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>扩展：针对判断整数的问题，可以有如下思路：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
123a
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN | sed s#[^0-9]##</span>
<span class="m">123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ &#34;`echo $LIXIN | sed s#[^0-9]##`&#34; = &#34;$LIXIN&#34; ] &amp;&amp; echo 1 || echo 0</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ &#34;`echo $LIXIN | sed s#[^0-9]##`&#34; = &#34;$LIXIN&#34; ] &amp;&amp; echo 1 || echo 0</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 把输入的字符串中的非数字替换为空，如果和源字符串相等，则表示输入的是数字。</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4562-打印菜单">4.5.6.2 打印菜单</h4>
<p>要求：</p>
<ol>
<li>当用户输入1时，输出&rsquo;start installing lamp'，然后执行/server/scripts/lamp.sh，脚本内容输入&rsquo;lamp is installed&rsquo;后退出脚本；</li>
<li>当用户输入2时，输出&rsquo;start installing lnmp'，然后执行/server/scripts/lnmp.sh，脚本内容输入&rsquo;lnmp is installed&rsquo;后退出脚本；</li>
<li>当用户输入3时，退出当前菜单及脚本；</li>
<li>当输入任何其他字符，给出提示&rsquo;input error&rsquo;后退出脚本</li>
<li>要对执行的脚本进行相关条件判断，例如：脚本是否存在，是否可以执行等。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat menu.sh</span>
<span class="c1">#!/bin/bash</span>
man<span class="o">(){</span>
cat <span class="s">&lt;&lt;EOF
</span><span class="s">    1.install lamp
</span><span class="s">    2.install lnmp
</span><span class="s">    3.exit
</span><span class="s">    please input number
</span><span class="s">    EOF</span>
<span class="o">}</span>
man
<span class="nb">read</span> num
<span class="k">if</span> <span class="o">[</span> <span class="nv">$num</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;installing lamp.......&#34;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="nv">$num</span> -eq <span class="m">2</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;installing lnmp.......&#34;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="nv">$num</span> -eq <span class="m">3</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;good bye&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;input error&#34;</span>
    <span class="nb">exit</span> <span class="m">2</span>
<span class="k">fi</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># </span>
</code></pre></td></tr></table>
</div>
</div><h2 id="44-分支与循环结构">4.4 分支与循环结构</h2>
<h3 id="441-if条件语句">4.4.1 if条件语句</h3>
<p><strong>1. 单分支结构：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> 条件 <span class="o">]</span>
    <span class="k">then</span>
       指令
<span class="k">fi</span>
<span class="c1"># 或</span>
<span class="k">if</span> <span class="o">[</span> 条件 <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    指令
<span class="k">fi</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>2. 双分支结构：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> 条件 <span class="o">]</span>
    <span class="k">then</span>
       指令1
<span class="k">else</span>
    指令2
<span class="k">fi</span>
<span class="c1"># 类似：[ -f /etc/hosts ] &amp;&amp; echo 0 || echo 1</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>3. 多分支结构:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> 条件1 <span class="o">]</span>
    <span class="k">then</span>
       指令1
<span class="k">elif</span> <span class="o">[</span> 条件2 <span class="o">]</span>
    <span class="k">then</span> 指令2
<span class="c1"># .......可以有多个elif</span>
<span class="k">else</span>
  指令3
<span class="k">fi</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：开发shell脚本判断系统剩余内存的大小，如果低于100M，就邮件报警给管理员，并且加入系统定时任务每3分钟执行一次检查。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># tail -1 /etc/mail.rc</span>
<span class="nb">set</span> <span class="nv">from</span><span class="o">=</span>beyondlee2011@126.com <span class="nv">smtp</span><span class="o">=</span>smtp.126.com smtp-auth-user<span class="o">=</span>beyondlee2011 smtp-auth-password<span class="o">=</span>aini3845 smtp-auth<span class="o">=</span>login
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat memtest.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">mem</span><span class="o">=</span><span class="sb">`</span>free -m <span class="p">|</span> awk <span class="s1">&#39;NR==3{print $NF}&#39;</span><span class="sb">`</span>
<span class="o">[</span> <span class="nv">$mem</span> -le <span class="m">100</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
   <span class="nb">echo</span> <span class="s1">&#39;mail is sending to Administrator.......&#39;</span>
   <span class="nb">echo</span> <span class="s2">&#34;memory is </span><span class="nv">$mem</span><span class="s2">&#34;</span> <span class="p">|</span> mail -s <span class="s2">&#34;Warning:memory is not enough&#34;</span> 287990400@qq.com
<span class="o">}</span>
//定时任务
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># crontab -l</span>
*/3 * * * * /bin/bash /server/scripts/memtest.sh <span class="p">&amp;</span>&gt;/dev/null
</code></pre></td></tr></table>
</div>
</div><p>例子2：用if双分支实现对mysql服务是否正常进行判断，使用端口，进程数或者URL的方式拍段，如果进程没起动，把进行启动</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat testmysql.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">mysqlinfor</span><span class="o">=</span><span class="sb">`</span>netstat -lntup <span class="p">|</span> grep <span class="m">3306</span> <span class="p">|</span> grep -v grep <span class="p">|</span> wc -l<span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$mysqlinfor</span> -ge <span class="m">1</span> <span class="o">]</span> <span class="p">;</span><span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&#34;mysql is started&#34;</span>
  <span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;mysql is starting&#34;</span>
    /data/3306/mysql start <span class="p">&amp;</span>&gt;/dev/null
    sleep <span class="m">3</span>
    <span class="nb">echo</span> <span class="s2">&#34;ok&#34;</span>
<span class="k">fi</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子3：以read读入的方式比较两个数的带下，用if多分支来实现。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat testnum.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input two number &#34;</span> a b
expr <span class="nv">$a</span> + <span class="nv">$b</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
  <span class="nb">echo</span> <span class="s2">&#34;please input number ok?&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
<span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
  <span class="nb">echo</span> <span class="s2">&#34;The First number is empty&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
<span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$b</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
  <span class="nb">echo</span> <span class="s2">&#34;The Seconed number is empty&#34;</span>
  <span class="nb">exit</span> <span class="m">3</span>
<span class="o">}</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span> -gt <span class="s2">&#34;</span><span class="nv">$b</span><span class="s2">&#34;</span> <span class="o">]</span>
  <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&gt;</span><span class="nv">$b</span><span class="s2">&#34;</span>
  <span class="k">elif</span> <span class="o">[</span> <span class="nv">$a</span> -lt <span class="s2">&#34;</span><span class="nv">$b</span><span class="s2">&#34;</span> <span class="o">]</span>
   <span class="k">then</span>
     <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&lt;</span><span class="nv">$b</span><span class="s2">&#34;</span>
  <span class="k">else</span>
   <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">=</span><span class="nv">$b</span><span class="s2">&#34;</span>
<span class="k">fi</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>扩展：<br>
判断mysql或者web服务共同方法：</p>
<ol>
<li>端口：<br>
本地：netstat/ss/lsof<br>
远程：telnet/nmap/nc命令</li>
<li>进程：<br>
本地：ps aux(ps -ef)</li>
<li>wget/curl(http方式，判断根据返回值或者返回内容)</li>
<li>header(http)，（根据状态码判断）</li>
<li>数据库特有，通过mysql客户端查看返回值</li>
</ol>
</blockquote>
<p>通过端口和进程判断：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;`netstat -lnt|grep 3306|awk -F &#34;</span><span class="o">[</span> :<span class="o">]</span>+<span class="s2">&#34; &#39;{print </span><span class="nv">$5</span><span class="s2">}&#39;`&#34;</span> <span class="o">=</span> <span class="s2">&#34;3306&#34;</span> <span class="o">]</span> 由于后面使用的是比较，所以如果使用-eq 进行比较的话，当mysql没有运行的时候，第一个变量就为空,所以<span class="o">[</span> <span class="s2">&#34;&#34;</span> -eq <span class="s2">&#34;3306&#34;</span> <span class="o">]</span>会报语法错误。所以使用<span class="o">=</span>号，用字符串进行比较。
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>ps -ef <span class="p">|</span> grep mysql <span class="p">|</span> grep -v grep <span class="p">|</span>wc -l<span class="sb">`</span> -gt <span class="m">0</span> <span class="o">]</span> 用这种方式比较的话，注意脚本的名称不要包含mysql
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>nc -w <span class="m">2</span> 10.0.0.7 <span class="m">3306</span> <span class="p">&amp;</span>&gt;/dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> ok <span class="p">|</span> grep ok <span class="p">|</span> wc -l<span class="sb">`</span> -gt <span class="m">0</span> <span class="o">]</span>
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>nmap 10.0.0.7 -p <span class="m">3306</span> 2&gt;/dev/null <span class="p">|</span> grep open <span class="p">|</span> wc -l <span class="sb">`</span> -gt <span class="m">0</span> <span class="o">]</span>
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>netstat -lntup <span class="p">|</span> grep mysqld <span class="p">|</span> wc -l <span class="sb">`</span> -gt <span class="m">0</span> <span class="o">]</span>
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>lsof -i tcp:3306 <span class="p">|</span> wc -l<span class="sb">`</span>  -gt <span class="m">0</span> <span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p>通过curl进行判断</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;`curl -I -s -o /dev/null -w &#34;</span>%<span class="o">{</span>http_code<span class="o">}</span><span class="se">\n</span><span class="s2">&#34; http://web`&#34;</span> <span class="o">=</span> <span class="s1">&#39;200&#39;</span> <span class="o">]</span> -I：取返回头。-s：静默模式。-o：输出信息到空。-w：只取返回值。
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>curl -I http://web 2&gt;/dev/null <span class="p">|</span> head -1 <span class="p">|</span> egrep <span class="s2">&#34;200|302|301&#34;</span> <span class="p">|</span> wc -l <span class="sb">`</span> -eq <span class="m">1</span> <span class="o">]</span> 默认情况下curl命令会带一些错误的头部信息，这个时候可以使用静默模式，或者使用2&gt;把错误信息输出到空
</code></pre></td></tr></table>
</div>
</div><p>范例：实现通过传参的方式往/etc/user.conf里添加用户，具体要求如下：</p>
<ol>
<li>脚本用法
USAGE：sh adduser {-add | -del | -search} username</li>
<li>传参需求
-add 表示添加，-del 表示删除， -search 表示查找</li>
<li>如果有同名的用户则不能添加，没有对应用户则无需删除，查找到用户以及没有用户时给出明确提示。</li>
<li>/etc/user.conf不能被所有外部用户直接删除及修改</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat adduser.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="o">[</span> <span class="nv">$UID</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">&#34;please use root&#34;</span>
    <span class="nb">exit</span> <span class="m">0</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">&#34;USAGE:sh /server/scripts/adduser { -add|-del|-search} username&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
<span class="nv">cmd</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">user</span><span class="o">=</span><span class="nv">$2</span>
<span class="nv">user_info</span><span class="o">=</span><span class="sb">`</span>grep <span class="nv">$user</span> /etc/user.conf <span class="p">|</span> wc -l<span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;0&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-add&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2">&#34;</span> &gt;&gt; /etc/user.conf
        <span class="nb">echo</span> <span class="s2">&#34;adduser </span><span class="nv">$user</span><span class="s2"> successful!&#34;</span>
        <span class="nb">exit</span> <span class="m">2</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-add&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2"> is cunzai&#34;</span>
        <span class="nb">exit</span> <span class="m">3</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;0&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-del&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2"> is not create,please create it first&#34;</span>
        <span class="nb">exit</span> <span class="m">4</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span> -a  <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-del&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        sed -i <span class="s2">&#34;/</span><span class="nv">$user</span><span class="s2">/d&#34;</span> /etc/user.conf
        <span class="nb">echo</span> <span class="s2">&#34;del user </span><span class="nv">$user</span><span class="s2"> successsful!!!&#34;</span>
        <span class="nb">exit</span> <span class="m">5</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-search&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;0&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2"> is not create,please create it first&#34;</span>
        <span class="nb">exit</span> <span class="m">6</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-search&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2"> is a good boy!&#34;</span>
        <span class="nb">exit</span> <span class="m">7</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;USAGE:sh /server/scripts/adduser { -add|-del|-search} username&#34;</span>
    <span class="nb">exit</span> <span class="m">8</span>
<span class="k">fi</span>
</code></pre></td></tr></table>
</div>
</div><p>面试及实战考试题：监控web站点目录(/var/html/www)下所有文件是否篡改（文件内容被改了），如果有就打印改动的文件名（发邮件），定时任务每3分钟执行一次。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat testweb.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">dir</span><span class="o">=</span>/var/www/html
<span class="nv">result</span><span class="o">=</span>/tmp/web.log
<span class="nv">ip</span><span class="o">=</span><span class="sb">`</span>ip addr ls eth0 <span class="p">|</span> awk -F <span class="s2">&#34;[ /]+&#34;</span> <span class="s1">&#39;NR==3{print $3}&#39;</span><span class="sb">`</span>
<span class="nv">error_file</span><span class="o">=</span>/tmp/error_file.log
<span class="o">[</span> -f <span class="nv">$result</span> <span class="o">]</span> <span class="o">||</span> <span class="o">{</span>
    find <span class="nv">$dir</span> -type f -name <span class="s2">&#34;*.html&#34;</span> <span class="p">|</span> xargs md5sum &gt;<span class="nv">$result</span>
<span class="o">}</span>

<span class="k">if</span> <span class="o">[</span> ! <span class="s2">&#34;`md5sum -c </span><span class="nv">$result</span><span class="s2"> 2&gt;/dev/null | grep FAILED | tee </span><span class="nv">$error_file</span><span class="s2"> | wc -l`&#34;</span> <span class="o">=</span> <span class="s2">&#34;0&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;web is not safe&#34;</span>
        mail -s <span class="s2">&#34;</span><span class="nv">$ip</span><span class="s2"> is not safe&#34;</span> daxin.li@foxmail.com &lt; <span class="nv">$error_file</span>
        mv <span class="nv">$result</span> /root/<span class="k">$(</span>date +%F<span class="k">)</span>_web_error.log
<span class="k">fi</span>
<span class="c1"># 保存退出</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#  crontab -l</span>
*/3 * * * * /bin/bash /server/scripts/testweb.sh <span class="p">&amp;</span>&gt;/dev/null
</code></pre></td></tr></table>
</div>
</div><h3 id="442-case结构条件句">4.4.2 case结构条件句</h3>
<p>case语句实际上就是规范的多分支if语句<br>
<strong>基本语法：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">case</span> <span class="s2">&#34;字符串变量&#34;</span> in
    值1<span class="o">)</span> 指令1..
<span class="p">;;</span>
    值2<span class="o">)</span> 指令2..
<span class="p">;;</span>
    值*<span class="o">)</span> 指令3..
<span class="k">esac</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：根据用户驶入判断是哪个数字，如果用户输入1或2或3，则输出对应输入的数字，如果是其他内容，返回不正确，退出</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat case1.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">a</span><span class="o">=</span><span class="nv">$1</span>
<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span> in
    1<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    2<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    3<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;input error&#34;</span>
<span class="k">esac</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：执行脚本打印一个水果菜单如下：</p>
<ol>
<li>apple</li>
<li>pear</li>
<li>banana</li>
<li>cherry</li>
</ol>
<p>当用户选择水果的时候，打印告诉它选择的水果是什么，并给水果单词加上一种颜色。要求用case语句实现。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat case2.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">RED</span><span class="o">=</span><span class="s2">&#34;\033[31m&#34;</span>
<span class="nv">GREEN</span><span class="o">=</span><span class="s2">&#34;\033[32m&#34;</span>
<span class="nv">YELLO</span><span class="o">=</span><span class="s2">&#34;\033[33m&#34;</span>
<span class="nv">BLUE</span><span class="o">=</span><span class="s2">&#34;\033[34m&#34;</span>
<span class="nv">PINK</span><span class="o">=</span><span class="s2">&#34;\033[35m&#34;</span>
<span class="nv">END</span><span class="o">=</span><span class="s2">&#34;\033[0m&#34;</span>

cat <span class="s">&lt;&lt; EOF
</span><span class="s">    1.apple
</span><span class="s">    2.pear
</span><span class="s">    3.banana
</span><span class="s">    4.cherry
</span><span class="s">    please input your choice
</span><span class="s">EOF</span>

<span class="nb">read</span> -t <span class="m">10</span> Fruit
<span class="k">case</span> <span class="nv">$Fruit</span> in
    1<span class="o">)</span> <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$RED</span><span class="s2"> apple </span><span class="nv">$END</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    2<span class="o">)</span> <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$GREEN</span><span class="s2"> pear </span><span class="nv">$END</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    3<span class="o">)</span> <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$BLUE</span><span class="s2"> banana </span><span class="nv">$END</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    4<span class="o">)</span> <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$PINK</span><span class="s2"> cherry </span><span class="nv">$END</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;please input {1|2|3|4}&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="k">esac</span>
</code></pre></td></tr></table>
</div>
</div><p>范例3：开发一个给指定内容加指定颜色的脚本要求：1.使用read或传参实现：2.case实现3.以传参为例：在脚本命令行传2个参参数，给指定内容(是第一个参数)加指定颜色（是第二个参数）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat color_case.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">RED</span><span class="o">=</span><span class="s2">&#34;\033[31m&#34;</span>
<span class="nv">GREEN</span><span class="o">=</span><span class="s2">&#34;\033[32m&#34;</span>
<span class="nv">YELLOW</span><span class="o">=</span><span class="s2">&#34;\033[33m&#34;</span>
<span class="nv">BLUE</span><span class="o">=</span><span class="s2">&#34;\033[34m&#34;</span>
<span class="nv">PINK</span><span class="o">=</span><span class="s2">&#34;\033[35m&#34;</span>
<span class="nv">END</span><span class="o">=</span><span class="s2">&#34;\033[0m&#34;</span>

Usage<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;Please input color and character!&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>

Color<span class="o">(){</span>
<span class="k">case</span> <span class="nv">$1</span> in
    RED<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$RED</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>
    <span class="p">;;</span>
    GREEN<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$GREEN</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>
    <span class="p">;;</span>
    YELLOW<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$YELLO</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>
    <span class="p">;;</span>
    BLUE<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$BLUE</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>  
    <span class="p">;;</span>
    PINK<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$PINK</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>
    <span class="p">;;</span>
    *<span class="o">)</span>
        <span class="nb">echo</span> <span class="s2">&#34;color is {RED|GREEN|YELLO|BLUE|PINK}&#34;</span>
        <span class="nb">exit</span> <span class="m">2</span>
    <span class="k">esac</span>
<span class="o">}</span>

main<span class="o">(){</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]</span>
        <span class="k">then</span>
            Usage
    <span class="k">fi</span>
    Color <span class="nv">$1</span> <span class="s2">&#34;</span><span class="nv">$2</span><span class="s2">&#34;</span>
<span class="o">}</span>
main <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>小结：</p>
<ol>
<li>case语句就相当于多分支的if语句。case语句优势更规范.易读。</li>
<li>case语句适合变量的值少，且为固定对的数字或字符串集合</li>
<li>系统服务启动脚本传参的判断多用case语句（值是固定的start|stop|status）</li>
</ol>
<h1 id="5-循环">5 循环</h1>
<p>        while循环工作中使用的不多，一般是守护进程或始终循环执行的场景会用，其他循环计算，都会用for替换while。</p>
<h2 id="51-当型循环和直到循环">5.1 当型循环和直到循环</h2>
<p><strong>1. while 条件句</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 语法：</span>
<span class="k">while</span> 条件
    <span class="k">do</span>
        指令
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>2. until 条件句 （很少用）</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 语法</span>
<span class="k">until</span> 条件
    <span class="k">do</span>
        指令
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="52-sleep休息命令">5.2 sleep休息命令</h2>
<p>语法：sleep 时间（单位是秒）<br>
扩展：usleep 微秒（1秒等于1,000,000微秒）<br>
注意：超过1分钟，要使用定时任务。<br>
例子：每隔两秒输出一个负载值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="k">while</span> <span class="nb">true</span>
    <span class="k">do</span>
        cat <span class="s">&lt;&lt; EOF
</span><span class="s">-----------------------------------------------------------------------------
</span><span class="s">EOF</span>
    uptime
    sleep <span class="m">2</span>
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>注意：while true表示条件永远为真，即永远执行下去。</p>
<h2 id="53-前后台运行">5.3 前后台运行</h2>
<p>        在执行脚本的时候加上&amp;，表示后台执行<br>
防止客户端执行脚本中的方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">1. sh scripts.sh <span class="p">&amp;</span>
2. nohup /server/scripts/scripts.sh <span class="p">&amp;</span>
3. screen 命令
</code></pre></td></tr></table>
</div>
</div><p>其他操作：</p>
<ul>
<li>&amp;：放在后台执行</li>
<li>jobs：查看当前窗口后台或暂停的任务</li>
<li>fg ID：把某一个任务调整到前台</li>
<li>bg ID：把某一个任务重新调成到后台</li>
<li>kill %ID：杀掉一个任务</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># sh while3.sh &amp;</span>
<span class="o">[</span>1<span class="o">]</span> <span class="m">67583</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># jobs</span>
<span class="o">[</span>1<span class="o">]</span>+  Running                 sh while3.sh <span class="p">&amp;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># kill %1</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># jobs</span>
<span class="o">[</span>1<span class="o">]</span>+  Terminated              sh while3.sh
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># jobs</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="54-while循环">5.4 while循环</h2>
<p>例子：计算1+&hellip;+100之和</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 方法1：</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim while_sum.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span>  <span class="o">((</span> <span class="nv">$i</span> &lt;<span class="o">=</span> <span class="m">100</span> <span class="o">))</span>
    <span class="k">do</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
        <span class="o">((</span>i++<span class="o">))</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>

<span class="c1"># 方法2：</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim while_sum.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span> <span class="o">[</span> <span class="nv">$i</span> -le <span class="m">100</span> <span class="o">]</span>
    <span class="k">do</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
        <span class="o">((</span>i++<span class="o">))</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>
</code></pre></td></tr></table>
</div>
</div><p>例2：列出10到1的所有数字</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat while_num.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span><span class="m">10</span>
<span class="k">while</span> <span class="o">[</span> <span class="nv">$i</span> -ge <span class="m">1</span> <span class="o">]</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
        <span class="o">((</span>i--<span class="o">))</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>练习题</p>
<ol>
<li>
<p>猜数字游戏：首先让系统随机生成一个数字，给这个数字定一个范围（数字前50及后50），让用户输入猜的数字，对输入判断，如果不符合数字就给予高与低的提示，猜对后给下猜对用的次数，请用while语句实现。</p>
</li>
<li>
<p>手机充值10元，每发一次短信（输出当前余额）花费1角5分钱，当余额低于1角5分钱不能发短信，提示余额不足，请充值(可以允许用户充值继续发短信)，请用while语句实现。
解答：单位换算。统一单位，统一成整数，10元=1000分，1角5分=15分</p>
</li>
</ol>
<h3 id="541-while循环读文件">5.4.1 while循环读文件</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 方式1：</span>
<span class="nb">exec</span> &lt; file
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        cmd
<span class="k">done</span>

<span class="c1"># 方式2：</span>
cat <span class="nv">$file_path</span><span class="p">|</span><span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        cmd
<span class="k">done</span>

<span class="c1">#方式3：</span>
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        cmd
<span class="k">done</span> &lt; FILE
</code></pre></td></tr></table>
</div>
</div><p>例子：记录日志中访问的文件的大小，并做加法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat access.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span><span class="m">0</span>
<span class="nv">sum</span><span class="o">=</span><span class="m">0</span>
<span class="nb">exec</span> &lt; /root/access.log
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        <span class="nv">i</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span> awk <span class="s1">&#39;{print $10}&#39;</span> <span class="p">|</span> grep -E <span class="s1">&#39;[0-9]+&#39;</span><span class="sb">`</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
<span class="k">done</span>
    <span class="nb">echo</span> <span class="nv">$sum</span>
<span class="c1"># 注意：由于有些访问客户端本地会缓存所以它不会下载，一般这种访问的大小为-，我这里做了grep过滤，即只把数字过滤出来，另一种方法为：</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim access_new.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        <span class="nv">i</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span> awk <span class="s1">&#39;{print $10}&#39;</span><span class="sb">`</span>
        expr <span class="nv">$i</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="k">continue</span>
        <span class="k">fi</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
<span class="k">done</span> &lt; /root/access.log
<span class="nb">echo</span> <span class="nv">$sum</span>
<span class="c1"># 解答：如果$i,不是数字，利用expr的方法判断是否是数字，不是的话，利用continue跳出本次循环，继续下一次。即不是数字的行不加</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：一个httpd.log日志10个IP记录，每十秒钟一个导出到nginx.log里，倒腾到nginx.log里和httpd.log内容一样。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat quip.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        <span class="nv">apple2</span><span class="o">=</span><span class="sb">`</span>grep <span class="nv">$line</span> /root/nginx.log <span class="p">|</span> wc -l <span class="sb">`</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$apple2</span> -eq <span class="m">0</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="nb">echo</span> <span class="nv">$line</span> &gt;&gt; /root/nginx.log
                sed -i <span class="s2">&#34;/</span><span class="nv">$line</span><span class="s2">/d&#34;</span> /root/httpd.log
                sleep <span class="m">10</span>
                <span class="k">continue</span>
        <span class="k">else</span>
            <span class="nb">echo</span> <span class="s2">&#34;the ip </span><span class="nv">$line</span><span class="s2"> are ready in /root/nginx.log&#34;</span>
            <span class="k">continue</span>
        <span class="k">fi</span>
<span class="k">done</span> &lt; /root/httpd.log
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># </span>
</code></pre></td></tr></table>
</div>
</div><h3 id="542-while循环小结">5.4.2 while循环小结</h3>
<ol>
<li>while循环的特长是执行守护进程以及我们系统循环不退出持续执行的情况，用于频率小于1分钟循环处理(crond)，其他的while循环几乎都可以被for替代。</li>
<li>if.for最常用.其次（守护进程），case（服务启动脚本）。</li>
</ol>
<h2 id="55-for循环">5.5 for循环</h2>
<ol>
<li>常规语法：</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">for</span> 变量 in 变量取值列表
<span class="k">do</span>
       指令
<span class="k">done</span>
<span class="c1"># 提示：在此结构中“in 变量取值列表” 可省略，使用for i 就相当于 for i in &#34;$@&#34;</span>
</code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>C语言型语法结构</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">for</span><span class="o">((</span>exp1<span class="p">;</span>exp2<span class="p">;</span>exp3<span class="o">))</span>
    <span class="k">do</span>
        指令
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：for和while对比</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;5<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="c1"># 对应的while循环实现方式</span>
<span class="nv">i</span><span class="o">=</span><span class="m">0</span>
<span class="k">while</span> <span class="o">((</span>i&lt;5<span class="o">))</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
        <span class="o">((</span>i++<span class="o">))</span>
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test3.sh</span>
<span class="c1">#!/bin.bash</span>
<span class="k">for</span> i in <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span> <span class="m">10</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>

<span class="c1"># 升级方法1</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test4.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> i in <span class="o">{</span>1..10<span class="o">}</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1">#升级方法2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test4.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> i in <span class="sb">`</span>seq 10<span class="sb">`</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：批量生成10个名称任意的文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test6.sh</span>
<span class="c1">#!/bin/bash</span>
mkdir ./test
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;10<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        touch ./test/<span class="sb">`</span><span class="nb">echo</span> <span class="nv">$RANDOM</span><span class="p">|</span>md5sum<span class="p">|</span>cut -c 1-8<span class="sb">`</span>.log
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子，批量改文件后缀名</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 test<span class="o">]</span><span class="c1"># ls</span>
01e2c72d.log  3a14455d.log  3be873ce.log  44902678.log  783e7809.log  7f1fcb3c.log  c4c2399d.log  d55801a9.log  f8e1527b.log
0d339dcf.log  3bc67de9.log  3d90e27a.log  77d45895.log  7a93b22e.log  a29613b1.log  c6909d86.log  ea69f47e.log  fa601ba4.log 

<span class="c1"># 方法1:</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test7.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">cd</span> /root/test
<span class="k">for</span> i in <span class="sb">`</span>find /root/test/ -name <span class="s2">&#34;*.log&#34;</span><span class="sb">`</span>
    <span class="k">do</span>
        <span class="nv">name</span><span class="o">=</span><span class="sb">`</span> <span class="nb">echo</span> <span class="nv">$i</span> <span class="p">|</span> awk -F <span class="s1">&#39;.&#39;</span> <span class="s1">&#39;{print $1}&#39;</span><span class="sb">`</span>
        mv <span class="nv">$i</span> <span class="si">${</span><span class="nv">name</span><span class="si">}</span>.html
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 方法2：（变量的替换功能）</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># vim test8.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">cd</span> /root/test
<span class="k">for</span> i in <span class="sb">`</span>ls<span class="sb">`</span>
    <span class="k">do</span>
        mv <span class="nv">$i</span> <span class="si">${</span><span class="nv">i</span><span class="p">/.html/.jpg</span><span class="si">}</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 方法3：拼接功能</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test9.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">cd</span> /root/test
<span class="k">for</span> i in <span class="sb">`</span>ls<span class="sb">`</span>
    <span class="k">do</span>
        mv <span class="nv">$i</span> <span class="sb">`</span><span class="nb">echo</span> <span class="nv">$i</span> <span class="p">|</span> sed <span class="s1">&#39;s#.jpg#.log#g&#39;</span><span class="sb">`</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 方法4:通过rename改名</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># vim test10.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">cd</span> /root/test
<span class="k">for</span> i in <span class="sb">`</span>ls<span class="sb">`</span>
    <span class="k">do</span>
        rename <span class="s2">&#34;.log&#34;</span> <span class="s2">&#34;.jpg&#34;</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
rename <span class="s2">&#34;把什么&#34;</span> <span class="s2">&#34;改成什么&#34;</span>  对谁修改
</code></pre></td></tr></table>
</div>
</div><p>例子：批量修改chkconfig管理</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># vim test11.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> i in <span class="sb">`</span>chkconfig --list <span class="p">|</span> grep 3:on <span class="p">|</span>awk <span class="s1">&#39;{print $1}&#39;</span><span class="p">|</span> grep -Ev <span class="s2">&#34;network|crond|rsyslog|sshd|sysstat&#34;</span><span class="sb">`</span>
    <span class="k">do</span>
        chkconfig <span class="nv">$i</span> off
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：利用for命令计算1..100的和</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># C语言型：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test12.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">sum</span><span class="o">=</span><span class="m">0</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span>100<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 普通型：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test13.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">sum</span><span class="o">=</span><span class="m">0</span>
<span class="k">for</span> i in <span class="sb">`</span>seq 100<span class="sb">`</span>
    <span class="k">do</span>
        <span class="nb">let</span> <span class="nv">sum</span><span class="o">+=</span>i
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>练习题：等差数列,计算n-m的累加之和可以用等差公式m(n+m)/2</p>
<h2 id="56-循环控制">5.6 循环控制</h2>
<p>$shell循环控制主要有四种方式：break、continue、exit、return。</p>
<ol>
<li>break、continue、exit一般用于循环结构中控制循环（for，while，if）的走向</li>
<li>break n：n表示跳出循环的层数，如果省略n，表示跳出整个循环</li>
<li>continue n：n表示退出到第n层继续循环，如果省略n表示跳过本次循环，忽略本次循环的声誉代码，进入循环的下一次循环</li>
<li>exit n：退出当前shell程序，n为返回值，n也可以省略，再下一个shell里通过$?接收这个n的值。</li>
<li>return n：由于在函数里，作为函数的返回值，用于判断函数执行是否正确。</li>
</ol>
<p>例子1：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test15.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span>5<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$i</span> -eq <span class="m">3</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="c1">#break</span>
                <span class="nb">exit</span>
                <span class="c1">#continue</span>
        <span class="k">fi</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s1">&#39;OK&#39;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># sh test15.sh</span>
<span class="m">1</span>
<span class="m">2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 注意：由于使用了exit，所以在循环到第三次的时候，就直接退出了脚本</span>
</code></pre></td></tr></table>
</div>
</div><p>例子2：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test15.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span>5<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$i</span> -eq <span class="m">3</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="c1">#break</span>
                <span class="c1">#exit</span>
                <span class="k">continue</span>
        <span class="k">fi</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s1">&#39;OK&#39;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># sh test15.sh</span>
<span class="m">1</span>
<span class="m">2</span>
<span class="m">4</span>
<span class="m">5</span>
OK
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 注意：由于使用了continue，所以在执行到第三次的时候，结束本次循环，继续执行下一次循环。</span>
</code></pre></td></tr></table>
</div>
</div><p>例子3：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test15.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span>5<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$i</span> -eq <span class="m">3</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="nb">break</span>
                <span class="c1">#exit</span>
                <span class="c1">#continue</span>
        <span class="k">fi</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s1">&#39;OK&#39;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># sh test15.sh</span>
<span class="m">1</span>
<span class="m">2</span>
OK
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 注意：由于使用了break，当执行到第三次的时候，跳出循环，继续执行其他命令。</span>
</code></pre></td></tr></table>
</div>
</div><p>练习题：开发shell脚本实现给服务器临时配置多个别名IP，并可以随时撤销配置的所以IP，IP地址为10.0.2.1-16，其中10.0.2.10不能配置。</p>
<h1 id="6-shell函数">6 shell函数</h1>
<p>        $简单的说，函数的作用就是把程序里多次调用相同的代码部分定义成一份，然后为这一份代码起个名字，其他所有的重复调用这部分代码就都可以只调用这个名字就OK了。当需要修改在这部分重复代码时，只需要改变函数体内的一份代码即可实现 所有调用修改。</p>
<h2 id="61-为什么要使用shell函数">6.1 为什么要使用shell函数</h2>
<p>使用函数的优势：</p>
<ol>
<li>把相同的程序段定义成函数，可以减少整个程序的代码量。</li>
<li>可以让程序代码结构更清晰。</li>
<li>增加程序的可读、易读性，以及可管理性。</li>
<li>可以实现程序功能模块化，不同的程序使用函数模块化。  <br>
<strong>注意：对应shell来说，linux的2000多个命令都可以说是shell的函数。</strong></li>
</ol>
<h2 id="62-shell函数语法">6.2 shell函数语法</h2>
<p>简单的语法格式:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">函数名称<span class="o">(){</span>
   指令...
   <span class="k">return</span> n
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>规范的语法格式:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">function</span> 函数名<span class="o">(){</span>
   指令...
   <span class="k">return</span> n
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>提示：shell的返回值是exit输出返回值，函数里用return输出返回值。</p>
<h2 id="63-shell的函数执行">6.3 shell的函数执行</h2>
<ol>
<li>直接执行函数名即可（不带括号）
<ul>
<li>执行函数的时候，不要带小括号。</li>
<li>函数的定义必须在函数调用前定义，shell的执行是从上到下按行执行的。</li>
</ul>
</li>
<li>带参数的函数执行方法：
<ul>
<li>函数名 参数1 参数2</li>
<li>函数的传参和脚本的传参类似，只是脚本名换成函数名即可。</li>
</ul>
</li>
</ol>
<p>注意：</p>
<ul>
<li>shell的位置参数($1、$2、$#、$*、$?、$@)都可以是函数的参数。</li>
<li>此时父脚本的参数临时地被函数参数所掩盖或隐藏。</li>
<li>$0比较特使，它仍是父脚本的名称。</li>
<li>当函数完成时，原来的命令行脚本的参数即恢复。</li>
<li>在shell函数里面，return命令功能与shell里的exit类似，作用是跳出函数。</li>
<li>在shell函数里使用exit会退出整个shell脚本，而不是退出shell函数。</li>
<li>return语句会返回一个退出值（返回值）给调用函数的程序。</li>
<li>函数的参数变量是在函数体里面定义，如果是普通变量一般会使用local i定义（函数里面的变量，只在本函数中生效）。</li>
</ul>
<p>实例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat hanshu.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">function</span> main<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;hello,i am handsome man&#34;</span>
<span class="o">}</span>
main
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># sh hanshu.sh</span>
hello,i am handsome man
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>注意:引用其他脚本的函数的时候，可以在本脚本中通过source或者.来调用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat hanshu.sh</span>
<span class="c1">#!/bin/bash</span>
. /etc/init.d/functions
<span class="k">function</span> main<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;hello,i am handsome man&#34;</span>
    action <span class="s2">&#34;is is ok&#34;</span> /bin/true
<span class="o">}</span>
main
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># sh hanshu.sh</span>
hello,i am handsome man
is is ok                                                   <span class="o">[</span>  OK  <span class="o">]</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：函数传参转成脚本命令传参，对任意指定URL判断是否异常。</p>
<ol>
<li>脚本传参检查url是否正常。</li>
<li>脚本的功能写成函数</li>
<li>函数传参转成脚本命令行传参，对任意指定的URL进行判断。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat testurl.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="o">[</span> -f /etc/init.d/functions <span class="o">]</span> <span class="o">&amp;&amp;</span> . /etc/init.d/functions
Usage<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;USAGE:</span><span class="nv">$0</span><span class="s2"> url&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>

testurl<span class="o">(){</span>
    <span class="nb">local</span> code
    <span class="nv">code</span><span class="o">=</span><span class="sb">`</span>curl -I -s <span class="nv">$1</span> -w <span class="s1">&#39;%{http_code}&#39;</span> --connect-timeout <span class="m">3</span> -o /dev/null<span class="sb">`</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$code</span> -eq <span class="m">200</span> <span class="o">]</span>
        <span class="k">then</span>
            action <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2"> url&#34;</span> /bin/true
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">fi</span>
    action <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2"> url&#34;</span> /bin/false
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>

main<span class="o">(){</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">1</span> <span class="o">]</span>
        <span class="k">then</span>
            Usage
    <span class="k">fi</span>
        testurl <span class="nv">$1</span>
<span class="o">}</span>
main <span class="nv">$*</span>
<span class="c1"># 注意：$*加上引号，才表示是一个变量，$*会把命令行的参数都传给shell脚本，比如我输入sh testurl.sh www.baidu.com www.qq.com,$*会直接把www.baidu.com www.qq.com传给shell，由于中间有空格，所以shell函数认为是两个变量，所以会报错。</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="631-shell脚本字体颜色">6.3.1 shell脚本字体颜色</h3>
<p>字体颜色：30-37</p>
<blockquote>
<p>echo -e &ldquo;\033[30m 黑色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[31m 红色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[32m 绿色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[33m 黄色字 \033[0m&rdquo; <br>
echo -e &ldquo;\033[34m 蓝色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[35m 紫色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[36m 天蓝字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[37m 白色字 \033[0m&rdquo;</p>
</blockquote>
<p>字背景颜色范围：40-47</p>
<blockquote>
<p>echo -e  &ldquo;\033[40;37m 黑底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[41;37m 红底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[42;37m 绿底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[43;37m 黄底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[44;37m 蓝底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[45;37m 紫底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[46;37m 天蓝底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[47;30m 白底黑字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[41;33m 红底黄字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[41;37m 红底白字 \033[0m&rdquo;</p>
</blockquote>
<p><strong>可以通过man console_code来查询</strong><br>
实例：传递两个参数给脚本，并打印对应颜色的字体</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat color.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">RED</span><span class="o">=</span><span class="s2">&#34;\033[31m&#34;</span>
<span class="nv">GREEN</span><span class="o">=</span><span class="s2">&#34;\033[32m&#34;</span>
<span class="nv">YELLO</span><span class="o">=</span><span class="s2">&#34;\033[33m&#34;</span>
<span class="nv">BLUE</span><span class="o">=</span><span class="s2">&#34;\033[34m&#34;</span>
<span class="nv">PINK</span><span class="o">=</span><span class="s2">&#34;\033[35m&#34;</span>
<span class="nv">END</span><span class="o">=</span><span class="s2">&#34;\033[0m&#34;</span>
Usage<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;Please input color and character!&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>

Color<span class="o">(){</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;RED&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$RED</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;GREEN&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$GREEN</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;YELLO&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$YELLO</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;BLUE&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$BLUE</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
   <span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;PINK&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$PINK</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">fi</span>
        <span class="nb">echo</span> <span class="s2">&#34;color is {RED|GREEN|YELLO|BLUE|PINK}&#34;</span>
        <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>

main<span class="o">(){</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]</span>
        <span class="k">then</span>
            Usage
    <span class="k">fi</span>
    Color <span class="nv">$1</span> <span class="nv">$2</span>
<span class="o">}</span>
main <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="7-shell数组">7 shell数组</h1>
<p>平时定义a1,b=2,c=3,变量如果多了，再一个一个定义很费劲，并且去变量也很费劲。<br>
简单的说，数组就是各种数据类型的元素按一定顺序排列的集合。<br>
数组就是把有限个元素变量或数据用一个名字命名，然后用编号区分他们的变量的集合。这个名字成为数组名，编号成为数组下标<br>
组成数组的各个变量成为数组的分量，也成为数组的元素，有时也成为下标变量。</p>
<h2 id="71-数组的定义">7.1 数组的定义</h2>
<p><strong>array=(1 2 3)</strong><br>
数组是一个特殊的变量。其中数组名为array，里面有3个元素，可以使用 <code>echo ${#array[*]}</code> ,来查看数组的长度。这里*和@都可以。<br>
注意：数组的下标从0开始，即0代表取数组内第一个数据<br>
例子：循环打印出数组中的IP地址</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 方法1：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat array.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">array</span><span class="o">=(</span>
    10.0.0.1
    10.0.0.2
    10.0.0.3
<span class="o">)</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;<span class="si">${#</span><span class="nv">array</span><span class="p">[*]</span><span class="si">}</span><span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="si">${</span><span class="nv">array</span><span class="p">[i]</span><span class="si">}</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 方法2：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat array1.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">array</span><span class="o">=(</span>
    10.0.0.1
    10.0.0.2
    10.0.0.3
<span class="o">)</span>
<span class="k">for</span> i in <span class="si">${</span><span class="nv">array</span><span class="p">[*]</span><span class="si">}</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
 
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="72-向数组的添加值">7.2 向数组的添加值</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># array=(1 2 3)</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># array[3]=4</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>7.3 删除数组中的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># unset array[0]</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
<span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>7.4 把命令的结果定义成array</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 方法1，通过$()取命令的结果</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># array=($(ls))</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
2016-07-01_web_error.log access.log array1.sh array.sh eluosi.sh for_sum.sh fruit.sh kuang2 menu.sh daxin.log daxinxin.log quip.sh <span class="nb">test</span> test10.sh test11.sh test12.sh test13.sh test14.sh test15.sh test1.sh test2.sh test3.sh test4.sh test5.sh test6.sh test7.sh test8.sh test9.sh test.sh while1.sh while2.sh while3.sh <span class="k">while</span>.sh
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 方法2：通过``取命令的结果</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># array=(`ip a l | grep eth | grep inet | awk &#39;{print $NF}&#39;`)</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[@]}</span>
eth0 eth1
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="75-小结">7.5 小结</h2>
<ol>
<li>定义
<ul>
<li>静态数组:array=(1 2 3)</li>
<li>动态数组：array=($(ls))</li>
<li>给数组赋值：array[1]=2</li>
</ul>
</li>
<li>打印
<ul>
<li>打印所有元素：${array[*]}或${array[@]}</li>
<li>打印数组长度：${#array[*]}或${#array[@]}</li>
<li>打印单个元素：${array[i]},i是数组的下标</li>
</ul>
</li>
</ol>
<hr>
<h2 id="mathjax-true">title: ShellNotes
date: 2016-01-25 06:00:58
lastmod: 2016-01-25 06:00:58
draft: false
tags: [Shell,]
categories: [Shell,]
author: &ldquo;daxin.li&rdquo;
comment: true
toc: true
reward: true
mathjax: true</h2>
<h1 id="1-什么是shell-1">1 什么是shell</h1>
<p>        shell是一个命令解释器，位于操作系统的最外层，它负责和用户直接对话，不用户输入的内容解释给操作系统，操作系统处理完毕后，输出结果，输出到屏幕上。分为交互式的和非交互式的。输入命令，得到结果。就是交互式的，执行脚本就是非交互的。
<strong>总结：shell就像是一座桥梁，连通用户和操作系统。</strong></p>
<h1 id="2-什么是shell脚本-1">2 什么是shell脚本</h1>
<p>        把一个或多个linux命令组合起来放在一个程序文件中执行，这样的程序叫做shell脚本。严格来说把命令.变量和流程控制语句等结合在一起，就是shell脚本</p>
<h2 id="21-如何写一个思路缜密的shell脚本-1">2.1 如何写一个思路缜密的shell脚本</h2>
<p>        要多去模拟操作，多去想想为什么</p>
<h2 id="22-shell的特点-1">2.2 shell的特点</h2>
<p>        linux中所有的配置文件.日志文件都是纯文本文件。而shell的特点就是善于处理纯文本的内容。</p>
<h2 id="23-shell的分类-1">2.3 shell的分类</h2>
<p>        bourne shell(包括 sh,ksh,bash) C shell(csh,tcsh)<br>
        查看系统支持的sh类型：/etc/shells,常用的就是/bin/sh,/bin/bash,/sbin/nologin<br>
        Linux主流的shell就是bash，它是bourne again shell的缩写，是由bonrne shell发展而来，它还包含了csh和ksh的特色。<br>
        <strong>目前：通用的bourne shell 已经被bash shell取代</strong></p>
<h2 id="24-其他脚本语言-1">2.4 其他脚本语言</h2>
<ol>
<li>php：主要用于web页面开发，适合wab前端展示</li>
<li>perl：比shell强大，语法灵活，实现方式很多，不易读，其中mysql的HA就是由perl写的</li>
<li>python：近几年很火的软件，不但可以开发前端，也可以开发后端，属于全能型语言</li>
</ol>
<h2 id="25-常用系统的默认shell-1">2.5 常用系统的默认shell</h2>
<p>        Linux：bash<br>
        solaris：bonrne sh<br>
        AIX：ksh<br>
        HP-unix：posix shell（sh）</p>
<h2 id="26-修改用户默认的shell-1">2.6 修改用户默认的shell</h2>
<p>        可以修改/etc/default/useradd文件的shell字段，更改新添加的用户。也可以直接修改/etc/passwd中的最后一个字段，直接修改某个用户的shell。</p>
<h2 id="27-shell脚本的建立-1">2.7 shell脚本的建立</h2>
<p>        <strong>通过vim编辑器编写shell脚本</strong> ,注意脚本的第一行 <strong>#!/bin/bash</strong> 表示来指定解释器</p>
<blockquote>
<p>注意：python 程序开头 #!/usr/bin/env python因为Linux默认就是使用bash，所以使用bash的话，可以不用加，为了规范还是要添加。如果不指定解释器，就需要用bash test.sh来执行了。<br>
注意：写脚本要写注释</p>
</blockquote>
<h2 id="28-shell脚本的执行-1">2.8 shell脚本的执行</h2>
<p>        当shell运行时，它会先查找系统环境变量ENV，该变量指定了环境文件（通常是.bashrc,.bash_profile,/etc/bashrc,/etc/profile等），然后从该环境变量文件开始执行脚本，当读取了ENV的文件后，shell会开始执行shell脚本中的内容。<br>
注意：设置cron任务时，最好把系统变量在脚本中重新定义一遍
<strong>shell脚本的执行通常采用以下几种方式</strong></p>
<ol>
<li>bash scripts-name 或 sh scripts-names （推荐）</li>
<li>patch/scripts-name 或 ./scripts-names （需要脚本有执行权限）</li>
<li>source scripts-name 或　. scripts-names （执行脚本的同时，使父shell继承子shell的变量)</li>
<li>sh&lt;scripts-name 或　cat scripts-name|sh</li>
</ol>
<blockquote>
<p>注意：我们用户登录的时候会默认分配一个shell，这个shell就是父shell，而在这个shell中执行的shell脚本，就属于子shell，父shell是不能直接继承子shell的变量的，但子shell可以直接继承父shell的变量，如果想要父shell获取子shell中的变量，就需要使用source或者.来执行脚本了。（相当于php中的include）</p>
</blockquote>
<h1 id="3-shell脚本开发基本规范-1">3 shell脚本开发基本规范</h1>
<ol>
<li>脚本第一行指定解释器</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash或者#!/bin/sh
</span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>脚本开头加版权信息</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#Date:</span>
<span class="c1">#Author: create by lixin</span>
<span class="c1">#Mail：</span>
<span class="c1">#Function:功能</span>
</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>脚本中不用中文注释</li>
<li>脚本使用.sh作为扩展名</li>
<li>写代码优秀习惯
<ul>
<li>成对的符号尽量一次打出来，防止遗漏</li>
</ul>
<ul>
<li>[ a ]中括号两端要有空格，书写的时候就街上，[[ a ]]双中括号也是如此。</li>
<li>流程控制语句一次书写完，在添加内容</li>
</ul>
</li>
</ol>
<h1 id="4-shell变量基础及深入-1">4 shell变量基础及深入</h1>
<h2 id="41-什么是变量-1">4.1 什么是变量</h2>
<p>        比如x=1,y=x+1,那么y等于2。x和y就是变量名，x变量的值是1，而y变量的值是x+1，等号在这里叫做赋值。
简单的说，变量就是用一个固定的字符串（也可能是字符数字等的组合），代替更多更复杂的内容，这个内容里可能还会包含变量.路径.字符串等其他的内容。
<strong>变量是暂时存数据的地方，这个存储的数据是存在于内存空间中的，通过调用变量的名字就可以取出变量对应的数据。</strong></p>
<h2 id="42-shell的变量特性-1">4.2 shell的变量特性</h2>
<p>        bash shell中默认的情况下是不会区分变量的内容的类型，例如：整数.字符串.小数等。这一点和其他强类型语言是有区别的。如果需要指定shell变量内容类型，可以使用declare显示指定定义变量的类型（没这个需求）。</p>
<h3 id="421-变量的类型-1">4.2.1 变量的类型</h3>
<p>        变量可以分为：环境变量（全局变量）和普通变量（局部变量）。<br>
        环境变量也成为全局变量，可以在创建他们的shell及其派生出来的任意子进程shell中使用，环境变量又可以分为自定义环境变量和bash内置的环境变量。<br>
        普通变量也可成为局部变量，只能在创建他们的shll函数或shell脚本中使用。普通变量一般是由开发者在开发脚本程序时创建的。</p>
<h3 id="422-环境变量-1">4.2.2 环境变量</h3>
<p>        环境变量一般用于定义shell的运行环境，保证shell命令的正确执行，shell通过环境变量来确定登录用户名.命令路径.终端类型.登录目录的等，所有的环境变量都是系统全局变量，可用于所有子进程中，这包括编辑器.shell脚本和各类应用（cron任务比较特殊需要注意）。<br>
        环境变量可以在命令行中设置创建，但用户退出命令是这些变量值就会丢失，因此，如果希望永久保存环境变量，可以在用户家目录下.bash_profile或.bashrc文件或全部配置文件/etc/profile或/etc/bashrc文件或者/etc/profile.d/下定义，因为每次用户登录时这些变量的值都会被初始化一次。<br>
        所有环境变量名字格式均为大写，环境变量用于用户进程程序前，都应该用export命令导出定义，例如：export KEY=1.<br>
        环境变量可以在创建他们的shell和从该shell派生的任意子shell或进程中，他们通常被称为全局变量以区别局部变量。通常，环境变量应该大写。环境变量是已经用export内置命令导出的变量。<br>
        有一些环境变量，比如HMOE.PATH.SHELL.UID.USER等，在用户登录之前就已经被/bin/login程序设置好了，通常环境变量定义并保存在用户家目录下的.bash_profile中。</p>
<h4 id="4221-定义全局变量格式-1">4.2.2.1 定义全局变量格式</h4>
<ol>
<li>export 变量名=value；</li>
<li>变量名=value；export 变量名</li>
<li>declare -x 变量名=value<br>
<strong>注意：如果是java环境，最后再脚本里面再定义一遍java环境变量。</strong></li>
</ol>
<h4 id="4222-显示与取消环境变量-1">4.2.2.2 显示与取消环境变量</h4>
<p>        通过echo或printf命令打印环境变量
例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">打印用户登录的目录: <span class="nb">echo</span> <span class="nv">$HOME</span>
打印用户的UID: <span class="nb">printf</span> <span class="nv">$UID</span>
使用env和set命令查看所有的环境变量
通过unset命令取消环境变量: <span class="nb">unset</span> NAME
</code></pre></td></tr></table>
</div>
</div><h4 id="4223-环境变量小结-1">4.2.2.3 环境变量小结</h4>
<ol>
<li>变量名通常要大写</li>
<li>可以在自身的shell以及子shell中使用</li>
<li>通过export来定义</li>
<li>查看使用echo $NAME</li>
<li>删除使用unset NAME</li>
<li>永久生效写入到用户环境变量文件，或者全局环境变量文件中。</li>
<li>写定时任务的时候，注意在脚本中添加环境变量（java）。</li>
</ol>
<h4 id="423-普通变量-1">4.2.3 普通变量</h4>
<p>        本地变量再用户当前的shell生存期的脚本中使用，例如，本地变量key的取值为123，这个值只在用户当前shell生存期中有意义。如果在shell中启动另一个进程或退出，本地变量key值将无效。</p>
<h4 id="4231-定义普通变量-1">4.2.3.1 定义普通变量</h4>
<p>定义普通变量的方法：</p>
<ol>
<li>变量名=value</li>
<li>变量名=&lsquo;value&rsquo;</li>
<li>变量名=&ldquo;value&rdquo;</li>
</ol>
<blockquote>
<p>其中，变量名一般是有字符，数字，下划线组成。可以字符或下划线开头，但是不能以数字开头。<br>
变量的内容，可以用单引号或双引号引起来，或不加引号。三者的区别是；不加引号，不能输入不连续的值，只要变量连续，可以解释其中引用的其他变量。单引号和echo中的单引号相同，就是内部有变量则不会解释变量，双引号即如果定义的值中引用其他变量，则解释该变量，变量的值可以是不连续的。而反引号，一般用来解析命令，相当于$().</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">例子：
 <span class="nv">a</span><span class="o">=</span>192.168.1.2
 <span class="nv">b</span><span class="o">=</span><span class="s1">&#39;192.168.1.2-$a&#39;</span>
 <span class="nv">c</span><span class="o">=</span><span class="s2">&#34;192.168.1.2-</span><span class="nv">$a</span><span class="s2">&#34;</span>
 <span class="nb">echo</span> <span class="nv">$a</span>
 192.168.1.2
<span class="nb">echo</span> <span class="nv">$b</span>
       192.168.1.2-<span class="nv">$a</span>
<span class="nb">echo</span> <span class="nv">$c</span>
 192.168.1.2-192.168.1.2

<span class="nv">a</span><span class="o">=</span>192.168.1.2-<span class="nv">$a</span>
<span class="nv">b</span><span class="o">=</span><span class="s1">&#39;192.168.1.2-$a&#39;</span>
<span class="nv">c</span><span class="o">=</span><span class="s2">&#34;192.168.1.2-</span><span class="nv">$a</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="nv">$a</span>
       192.168.1.2-192.168.1.2
<span class="nb">echo</span> <span class="nv">$b</span>
       192.168.1.2-<span class="nv">$a</span>
<span class="nb">echo</span> <span class="nv">$c</span>
       192.168.1.2-192.168.1.2-192.168.1.2
注意：日常定义变量如果是纯数字的话可以不加引号，其他情况建议都使用双引号。
扩展：把命令的结果作为变量
<span class="nv">变量名</span><span class="o">=</span><span class="sb">`</span>ls<span class="sb">`</span>或者 <span class="nv">变量名</span><span class="o">=</span><span class="k">$(</span>ls<span class="k">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4232-普通变量小结-1">4.2.3.2 普通变量小结</h4>
<ol>
<li>连续的数字字符串可以不加引号</li>
<li>变量内容是命令的结果，定义时可以使用反引号或$().</li>
<li>若变量和其他字符连接的时候，就必须给变量加上大括号{}。_<em>${key}<em>keyname;</em></em></li>
</ol>
<h4 id="4233-变量的高级应用-1">4.2.3.3 变量的高级应用</h4>
<p>定义变量后可以直接在各个地方调用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">key</span><span class="o">=</span>init
grep <span class="nv">$key</span> /etc/iniitab
grep <span class="s2">&#34;</span><span class="nv">$key</span><span class="s2">&#34;</span> /etc/inittab
<span class="c1"># 上面两个会过滤出/etc/inittab中包含init字符串的行</span>
grep <span class="s1">&#39;$key&#39;</span> /etc/inittab
<span class="c1"># 单引号，则会过滤出/etc/inittab中包含$key的行,同样适用于sed。</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>注意：awk中不同于grep和sed中</strong><br>
awk中的特殊用法1：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-awk" data-lang="awk"><span class="nx">key</span><span class="o">=</span><span class="nx">init</span>
<span class="nx">awk</span> <span class="s1">&#39;BEGIN{print &#34;$key&#34;}&#39;</span>
<span class="c1"># awk中&#34;&#34;是不解释变量的，和常规的相反，只有使用单引号才会解析。</span>
<span class="nx">awk</span> <span class="s1">&#39;BEGIN{print &#39;</span><span class="o">$</span><span class="nx">key</span><span class="s1">&#39;}&#39;</span>
<span class="c1"># 不加引号，则不会输出</span>
</code></pre></td></tr></table>
</div>
</div><p>awk中的特殊用法2：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-awk" data-lang="awk"><span class="nx">key</span><span class="o">=</span><span class="s1">&#39;int&#39;</span>
<span class="nx">awk</span> <span class="s1">&#39;BEGIN{print &#39;</span><span class="o">$</span><span class="nx">key</span><span class="s1">&#39;}&#39;</span>
<span class="c1"># 这时也是不会输出内容的，需要在单引号外面再加一层双引号才可以</span>
<span class="nx">awk</span> <span class="s1">&#39;BEGIN{print &#34;&#39;</span><span class="o">$</span><span class="nx">key</span><span class="s1">&#39;&#34;}&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="424-shell的特殊重要变量-1">4.2.4 shell的特殊重要变量</h3>
<h4 id="4241-位置变量-1">4.2.4.1 位置变量</h4>
<p>        <strong>$0</strong> 获取当前执行的shell脚本，如果执行脚本带路径那么就包括脚本路径。<br>
        <strong>$n</strong> 获取当前执行的shell脚本的第n个参数的值，n=1..9，当n为0时表示脚本的文件名，如果n大于9，用大括号括起来${10}.例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 创建测试文件：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo -n &#39;echo &#39; &gt; test1.sh &amp;&amp; echo \${1..15} &gt;&gt; test.sh</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test.sh</span>
<span class="nb">echo</span> <span class="nv">$1</span> <span class="nv">$2</span> <span class="nv">$3</span> <span class="nv">$4</span> <span class="nv">$5</span> <span class="nv">$6</span> <span class="nv">$7</span> <span class="nv">$8</span> <span class="nv">$9</span> <span class="nv">$10</span> <span class="nv">$11</span> <span class="nv">$12</span> <span class="nv">$13</span> <span class="nv">$14</span> <span class="nv">$15</span> <span class="nv">$16</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># bash test.sh {a..z}</span>
a b c d e f g h i a0 a1 a2 a3 a4 a5 a6
<span class="c1"># 由于变量超过了9个，所以从第10个变量开始要加大括号，不然shell认为$10，是$1的值和0组合在一起，所以才会显示a0</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test.sh</span>
<span class="nb">echo</span> <span class="nv">$1</span> <span class="nv">$2</span> <span class="nv">$3</span> <span class="nv">$4</span> <span class="nv">$5</span> <span class="nv">$6</span> <span class="nv">$7</span> <span class="nv">$8</span> <span class="nv">$9</span> <span class="si">${</span><span class="nv">10</span><span class="si">}</span> <span class="si">${</span><span class="nv">11</span><span class="si">}</span> <span class="si">${</span><span class="nv">12</span><span class="si">}</span> <span class="si">${</span><span class="nv">13</span><span class="si">}</span> <span class="si">${</span><span class="nv">14</span><span class="si">}</span> <span class="si">${</span><span class="nv">15</span><span class="si">}</span> <span class="si">${</span><span class="nv">16</span><span class="si">}</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># bash test.sh {a..z}</span>
a b c d e f g h i j k l m n o p
<span class="c1"># $# 表示脚本传参的个数，脚本名称后面的参数的个数.</span>
<span class="c1"># $* 将命令行脚本所有参数视为单个字符串等同于&#34;$1$2$3&#34;,$*要用双引号。</span>
<span class="c1"># $@ 将命令行脚本每个参数视为单独的字符串，等同于&#34;$1&#34;,&#34;$2&#34;,&#34;$3&#34;,这是将参数传递给其他程序的最佳方式，因为他会保留所有内嵌在每个参数里的任何空白。</span>
<span class="c1"># 注意：上述区别仅限于添加双引号的时候，即&#34;$*&#34;和$&#34;@&#34;</span>
例：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># set -- a b c</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># for i in &#34;$@&#34; ;do echo $i; done;</span>
a
b
c
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># for i in &#34;$*&#34; ;do echo $i; done;</span>
a b c
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4242-进程状态变量-1">4.2.4.2 进程状态变量</h4>
<p>        $? 查看上一个命令的执行结果。0表示成功，非0表示不成功。</p>
<blockquote>
<p>错误代码返回值参考：<br>
2：权限不够<br>
1-125:表示运行失败（脚本命令.系统命令错误或参数传递错误）<br>
126：找到该命令了，但无法执行<br>
127：命令找不到<br>
128:被强制中断了 <br>
注意：在shell脚本中一般用exit 数字，来把返回值传递给$?
如果是函数，则通过return 数字，返回返回值给$?<br>
扩展：通过set命令进传参<br>
<a href="http://httpd.blog.51cto.com/2561410/1175971">http://httpd.blog.51cto.com/2561410/1175971</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">set</span> -- <span class="s1">&#39;i am&#39;</span> handsome boy 传递3个参数到shell
<span class="nb">set</span> -- <span class="m">1</span> <span class="m">2</span> <span class="m">3</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo $1 $2 $3</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span>
<span class="c1"># $$ 显示当前进程的进程号</span>
<span class="c1"># $! 上一个进程的id号</span>
cat pid.sh
<span class="nb">echo</span> <span class="nv">$$</span> &gt;/tmp/a.pid
sleep <span class="m">300</span>

sh pid.sh <span class="p">&amp;</span>
cat /tmp/a.pid
</code></pre></td></tr></table>
</div>
</div><h4 id="4243-bash内置命令-1">4.2.4.3 bash内置命令</h4>
<p>        bash的内置命令，这些命令内置在bash中，没有绝对路径，需要时可以直接在shell脚本中调用 <strong>alias, bg, bind, break, builtin, caller, cd,command, compgen, complete, compopt, continue, declare, dirs,disown,  echo,  enable,  eval, exec, exit, export, false, fc,fg, getopts, hash, help, history,  jobs,  kill,  let,  local,logout,  mapfile,  popd,  printf, pushd, pwd, read, readonly,return, set, shift,  shopt,  source,  suspend,  test,  times,trap,  true,  type,  typeset,  ulimit, umask, unalias, unset,wait</strong></p>
<h3 id="4244-变量子串-1">4.2.4.4 变量子串</h3>
<p>        通过man bash找到Parameter Expansion来查看子串的全部用法<br>
        ${#变量名}取变量的长度</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># httpd=&#34;I am httpd&#34;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo $httpd</span>
I am httpd
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo $httpd|wc -L</span>
<span class="m">11</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${#httpd}</span>
<span class="m">11</span>
</code></pre></td></tr></table>
</div>
</div><p>        通过使用expr命令计算变量的长度</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># expr length &#34;$httpd&#34;</span>
<span class="m">11</span>

<span class="c1"># 计算I am good boy,welcome to myhome中字母小于5个的并打印</span>
<span class="k">for</span> i in I am good boy,welcome to myhome
<span class="k">do</span>
<span class="o">[</span> <span class="si">${#</span><span class="nv">i</span><span class="si">}</span> -lt <span class="m">5</span> <span class="o">]</span> <span class="o">&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$i</span><span class="s2">&#34;</span>
<span class="o">}</span>
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>        ${变量：2}截取变量的第几个字符到最后</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># httpd=&#34;I am httpd&#34;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${httpd:2}</span>
am httpd
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${httpd:3}</span>
m httpd
</code></pre></td></tr></table>
</div>
</div><p>        ${#变量:n:m}从第n个字符开始截取m个</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${httpd:2:2}</span>
am
</code></pre></td></tr></table>
</div>
</div><p>        ${变量#字符串}从开头开始匹配，删除最短匹配字符串的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
<span class="m">123123123123123123123123456</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN#1*3}</span>
<span class="m">123123123123123123123456</span>
</code></pre></td></tr></table>
</div>
</div><p>        ${变量##字符串}从开头开始匹配，删除最长匹配字符串的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN##1*3}</span>
<span class="m">456</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
i am good boy boy
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN%b*y}</span>
i am good boy
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN%%b*y}</span>
i am good
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>小结：</p>
<ol>
<li>#是开头删除匹配最短</li>
<li>##是开头删除匹配最长</li>
<li>%是结尾删除匹配最短</li>
<li>%%是结尾删除匹配最长</li>
</ol>
</blockquote>
<p>        ${变量/字符串1/字符串2}，从开头开始，把变量中的字符串1替换为字符串2.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=&#34;i am good boy boy&#34;</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
i am good boy boy
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN/boy/girl}</span>
i am good girl boy
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN//boy/girl}</span>
i am good girl girl
两个斜线表示替换所有符合的字符串
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN/#boy/girl}</span>
i am good boy boy
<span class="c1">#表示以boy开头的，替换为girl，由于变量LIXIN没有以boy开头，所以不会替换</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN/%boy/girl}</span>
i am good boy girl
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4245-变量替换-1">4.2.4.5 变量替换</h4>
<p><strong>${values:-word}</strong> 如果变量名称存在并且非null，则返回变量的值。否则返回word字符串，表示如果变量未定义，则返回默认值。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${lixin:-test}</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># lixin=123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${lixin:-test}</span>
<span class="m">123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $lixin</span>
空
</code></pre></td></tr></table>
</div>
</div><p><strong>${value:=word}</strong> 如果变量名存在且非null，则返回变量值。否则，设置这个变量为word，并返回其值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${lixin:=test}</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $lixin</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意：-和=的区别是，-表示变量为空的时候返回的默认值，这个默认值并不会被赋予变量，所以echo变量的时候依旧为空，=表示如果变量为空，则把word赋予该变量。<br>
扩展：这个冒号：也可以不加，功能和加上是相同的</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># unset LIXIN</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN-test}</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN-test}</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># unset LIXIN</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${LIXIN=test}</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4246-变量的数值整数计算-1">4.2.4.6 变量的数值(整数)计算</h4>
<p>变量的数值计算常见的有如下几个命令：<strong>(()),let,expr,bc(小数运算)，${}，其他都是整数。</strong><br>
常用运算符号：</p>
<ul>
<li>++，&ndash;：增加或减少，可以前置也可以放在末尾</li>
<li>+,-,*,/,%：分别对应加.减.乘，除，求余</li>
<li>&lt;,&lt;=,&gt;,&gt;=：分别对应小于，小于等于，大于，大于等于</li>
<li>==，!=：等于，不等于</li>
<li>&amp;&amp;：逻辑和，即command1 &amp;&amp; comand2 ，command1成功则执行command2。</li>
<li>||：逻辑或，即command1 || comand2，command1不成功则执行command2。</li>
<li>=，+=，-=，<em>=，/=，%=，赋值运算符，a+=1,表示a=a+1,a</em>=1,表示a=a*1。</li>
</ul>
<p><strong>1.(())用法</strong><br>
如果要执行简单的整数就算，只需要将特定的算数表达式用$(())括起来即可。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((1+2))</span>
<span class="m">3</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $(1+2)</span>
-bash: 1+2: <span class="nb">command</span> not found

<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># ((a=1+2**3-4%3))</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
+<span class="o">=</span>例子：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a+=1))</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a-=1))</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
n++例子：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a++))</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a--))</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
++n例子：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((a--))</span>
<span class="m">9</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((--a))</span>
<span class="m">7</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">7</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $((++a))</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $a</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>小结: n++和++n的区别是，变量n在前，则表达式的值为n，然后n自增或自减，变量n在后，则表达式的值为自增自减后的n</p>
<p><strong>2.let命令（用于整数计算）</strong><br>
格式：let 赋值表达式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># i=2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># i=i+8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $i</span>
i+8
<span class="c1"># 因为定义了两次i，所以第二次会覆盖之前对于i的定义</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># i=2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># let i=i+8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $i</span>
<span class="m">10</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># let的效果和(())相同，但效率不如(())高，所以建议用双括号</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>3.expr</strong></p>
<ul>
<li><strong>计算(整数数字，并且要有空格)</strong></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 1 + 2</span>
<span class="m">3</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 1+2</span>
1+2
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 注意：除号.乘号需要用反斜线转意</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 2 \* 2</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>判断是否为整数</strong><br>
由于expr不能计算非整数的表达式，可以通过expr的返回值确定传递的变量是否为整数。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 1 + a</span>
expr: non-numeric argument
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $?</span>
<span class="m">2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr 1 + 1</span>
<span class="m">2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $?</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat ceshi.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">a</span><span class="o">=</span><span class="nv">$1</span>
expr <span class="nv">$a</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]||{</span>
 <span class="nb">echo</span> <span class="s2">&#34;please input number&#34;</span>
<span class="o">}</span>
<span class="c1"># 或者</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat ceshi1.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">a</span><span class="o">=</span><span class="nv">$1</span>
expr <span class="nv">$a</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;{</span>
 <span class="nb">echo</span> <span class="s2">&#34;please input number&#34;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>计算字符串的长度</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr length $LIXIN</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
<span class="nb">test</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
其他计算变量长度的方法：
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo ${#LIXIN}</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN|wc -L</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN | awk &#34;{print length $0}&#34;</span>
<span class="m">4</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>expr判断后缀名</strong><br>
通过expr对变量进行模式匹配,格式为:expr value : 关键字</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=test.pub</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr $LIXIN : &#34;.*\.pub&#34;</span>
<span class="m">8</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=test.puv</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># expr $LIXIN : &#34;.*\.pub&#34;</span>
<span class="m">0</span>
<span class="c1"># 匹配为0，不匹配则非0</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>time命令</strong> 计算命令的运行时间（真实时间.内核时间.用户时间）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># time sh bianliang1.sh 1</span>

real 0m0.003s
user       0m0.001s
sys  0m0.000s
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 该命令可以对相同结果的命令进行压力测试，看哪个执行速度更快</span>
</code></pre></td></tr></table>
</div>
</div><p>小结：内置功能速度更快（${#value}计算速度最快）
<strong>bc命令</strong><br>
linux内置命令，同时也是一个计算器，直接输入bc，会进入计算器界面。并且bc支持小数(awk也支持小数)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 命令行：</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo 1+2|bc</span>
<span class="m">3</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo 2*2|bc</span>
<span class="m">4</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 转换成二进制</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo &#34;obase=2;255&#34;|bc</span>
<span class="m">11111111</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 确定小数点后数字的个数</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo &#34;scale=2;10/3&#34;|bc</span>
3.33
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo &#34;scale=3;10/3&#34;|bc</span>
3.333
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># awk方法计算小数</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo &#34;1.5 2.3&#34;|awk &#39;{print ($1*$2)}&#39;</span>
3.45
<span class="c1"># 例题:</span>
<span class="c1"># 计算1+2+3+4+5+6+7+8+9+10的值，并且列出1+2+3+4+5+6+7+8+9+10=55的结果</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo `seq -s &#39;+&#39; 10`=`seq -s &#39;+&#39; 10|bc`</span>
1+2+3+4+5+6+7+8+9+10<span class="o">=</span><span class="m">55</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># a=`seq -s &#34;+&#34; 10` &amp;&amp; echo $a=`echo $a|bc`</span>
1+2+3+4+5+6+7+8+9+10<span class="o">=</span><span class="m">55</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>小结：常用的shell的数值运算方法为(())和let</p>
<h3 id="423-变量的输入-1">4.2.3 变量的输入</h3>
<p>shell变量除了可以直接复制或脚本传参外，还可以使用read命令从标准输入获得，read为bash内置命令，可以通过help read查看帮助<br>
<strong>格式：read [参数] [变量名]</strong><br>
常用参数: -p,设置提示时间。-t，设置等待时间，默认单位为秒</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># read -t 10 -p &#34;please input two number&#34;</span>
please input two number1 <span class="m">2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># read -t 10 -p &#34;please input two number&#34; a b</span>
please input two number1 <span class="m">2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo $a $b</span>
<span class="m">1</span> <span class="m">2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>在脚本中通过read命令进行传参</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim read.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input two number&#34;</span> a b
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">+</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">+</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">-</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">-</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">/</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">/</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">*</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">*</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
扩展：read的提示性信息，可以通过
<span class="nb">echo</span> -n <span class="s1">&#39;please input two number&#39;</span>
<span class="nb">read</span> a b
来获取
</code></pre></td></tr></table>
</div>
</div><p>扩展题目：使用read读入2个变量，计算他们的加减乘除结果，并且判断是否为2个变量，以及是否为整数，当第二个数为被除数的时候不能为0</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim read.sh</span>

<span class="c1">#!/bin/bash</span>
<span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input two number&#34;</span> a b
<span class="o">[</span> -z <span class="nv">$a</span>  <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;the First number is null,please input number&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>  --&gt;可以通过<span class="si">${#</span><span class="nv">value</span><span class="si">}</span>，如果返回值为0，表示变量为空
<span class="o">[</span> -z <span class="nv">$b</span>  <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;the Seconed number is null,please input number&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
expr <span class="nv">$a</span> + <span class="nv">$b</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="nv">result</span><span class="o">=</span><span class="nv">$?</span>
<span class="o">[</span> <span class="nv">$result</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;please input two number&#34;</span>
  <span class="nb">exit</span> <span class="m">3</span>
<span class="o">}</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">+</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">+</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">-</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">-</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">*</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">*</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
<span class="o">[</span> <span class="nv">$b</span> -eq  <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
 <span class="nb">echo</span> <span class="s2">&#34;The Seconed is &#34;</span><span class="nv">$b</span><span class="s2">&#34;,can not calc /&#34;</span>
 <span class="nb">exit</span> <span class="m">4</span>
<span class="o">}</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">/</span><span class="nv">$b</span><span class="s2">=</span><span class="k">$((</span><span class="nv">$a</span><span class="o">/</span><span class="nv">$b</span><span class="k">))</span><span class="s2">&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="43-条件测试与比较-1">4.3 条件测试与比较</h2>
<p>        在bash的各种流程控制结果中，通常要进行各种测试，然后根据测试结果珍惜ing不同的操作，有时也会通过与if等条件语句相结合，更方便的完成判断。</p>
<h3 id="431-条件测试表达式-1">4.3.1 条件测试表达式</h3>
<p>条件测试有三种语法形式：</p>
<ol>
<li><strong>test &lt;测试表达式&gt;</strong></li>
<li><strong>[&lt;测试表达式&gt;]</strong></li>
<li><strong>[[&lt;测试表达式&gt;]]</strong></li>
</ol>
<blockquote>
<p>说明：<br>
1.其中1和2是等价的，只是写法不同。<br>
2.在[[]]中可以使用通配符进行模式匹配。&amp;&amp;.||.&lt;.&gt;等操作符可以直接应用于[[]]中，但不能应用于[]中。<br>
3.对于整数的关系运算，也可以使用shell的算数运算符(())。</p>
</blockquote>
<h4 id="4311-test-测试表达式-1">4.3.1.1 test &lt;测试表达式&gt;</h4>
<p>格式为：<strong>test [option] 目标</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -f /etc/hosts &amp;&amp; echo 0 || echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -x /etc/hosts &amp;&amp; echo 0 || echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -x /server/scripts/pid.sh &amp;&amp; echo 0 || echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -d /etc/hosts &amp;&amp; echo 0 || echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># test -d /etc &amp;&amp; echo 0 || echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4312-表达式-1">4.3.1.2 [&lt;表达式&gt;]</h4>
<p><strong>格式为：[ 选项 目标 ]</strong><br>
多个条件使用-a（并且），-o（或），来链接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -f /etc/hosts ] &amp;&amp; echo 0||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -f /etc/hosts -a -f /etc ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">1</span>
<span class="c1"># 由于etc不是文件，所以表达式为假</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -d /etc/host ] &amp;&amp; echo 0||echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -d /etc/hosts -a -d /etc ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">1</span>
<span class="c1"># 由于hosts不是目录，所以表达式为假</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -x /etc/host ] &amp;&amp; echo 0||echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4313-表达式-1">4.3.1.3 [[&lt;表达式&gt;]]</h4>
<p><strong>格式为：[[ 选项 目标 ]]</strong><br>
多个条件使用&amp;&amp;（并且），||（或），来链接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [[ -f /etc/hosts ]] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [[ -f /etc/hosts -a /etc/services ]] &amp;&amp; echo 0 ||echo 1</span>
-bash: syntax error in conditional expression
-bash: syntax error near <span class="s1">&#39;-a&#39;</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [[ -f /etc/hosts &amp;&amp; /etc/services ]] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># [[]]与[]不同的是表示逻辑关系的时候，&amp;&amp;（-a），||（-o）。</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="432-文件测试表达式-1">4.3.2 文件测试表达式</h3>
<p>部分选项如下：</p>
<ul>
<li>-f FILE:当测试文件存在，并且是一个普通文件，表达式的值为真</li>
<li>-d FILE:当测试文件是目录，表达式为真</li>
<li>-s FILE:当测试文件存在，并且非空，表达式的值为真</li>
<li>-e FILE:当测试文件存在(只要存在)，表达式为真</li>
<li>F1 -nt F2: F1比F2新</li>
<li>F1 -ot F2：F1比F2旧</li>
<li>-x FILE:当测试文件对当前用户来说可执行，表达式为真</li>
<li>-a FILE:当测试文件存在，表达式为真</li>
<li>-b FILE:当测试文件为块设备，表达式为真</li>
<li>-c FILE:当测试文件为字符设备，表达式为真</li>
<li>-g FILE:当测试文件拥有set GID，表达式为真</li>
<li>-h FILE:当测试文件为硬链接文件，表达式为真</li>
<li>-L FILE:当测试文件为软链接文件，表达式为真</li>
<li>-k FILE:当测试文件拥有sticky biy，表达式为真</li>
<li>-p FILE:当测试文件为管道文件，表达式为真</li>
<li>-r FILE:当测试文件对当前用户来说可读，表达式为真</li>
<li>-S FILE:当测试文件为socket文件，表达式的值为真</li>
<li>-u FILE:当测试文件拥有set UID，表达式为真</li>
<li>-w FILE:当测试文件对当前用户来说可写，表达式为真　　　　</li>
</ul>
<p><strong>注：在选项前加！表示取反</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 例：高效的判断方法</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ -f /etc/host ] || echo 123</span>
<span class="m">123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat tiaojiao.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="o">[</span> -f <span class="nv">$1</span> <span class="o">]</span> <span class="o">||</span> <span class="o">{</span>
  <span class="nb">echo</span> <span class="m">1</span>
  <span class="nb">echo</span> <span class="m">2</span>
  <span class="nb">echo</span> <span class="m">3</span>
<span class="o">}</span>
<span class="c1"># 判断$1是否是文件，不是得话输出1，2，3</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># sh tiaojian.sh /etc/host</span>
<span class="m">1</span>
<span class="m">2</span>
<span class="m">3</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="433-字符串测试表达式-1">4.3.3 字符串测试表达式</h3>
<ul>
<li>-z &ldquo;string&rdquo;:当字符串为空，表达式为真</li>
<li>-n &ldquo;string&rdquo;:当字符串不为空，表达式为真</li>
<li>&ldquo;string 1&rdquo; = &ldquo;string 2&rdquo;:当字符串1和字符串2相等，则表达式为真，=号可以用==代替</li>
<li>&ldquo;string 1&rdquo; != &ldquo;string 2&rdquo;:当字符串1不等于字符串2，表达式为真</li>
</ul>
<p>注意：</p>
<ol>
<li>字符串用双引号&quot;&quot;,引起来</li>
<li>等号两边要有空格</li>
</ol>
<h3 id="434-整数测试表达式-1">4.3.4 整数测试表达式</h3>
<p><strong>在[]和test中 在[[]]和(())中 含义</strong></p>
<ul>
<li>-eq =或== 等于</li>
<li>-ne != 不等于</li>
<li>-gt &gt; 大于</li>
<li>-lt &lt; 小于</li>
<li>-ge &gt;= 大于等于</li>
<li>-le &lt;= 小于等于</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 例：生产中一般使用[]和eq这样的搭配</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
<span class="m">2</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ $LIXIN -ne 0 ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ $LIXIN -eq 2 ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ $LIXIN -eq 3 ] &amp;&amp; echo 0 ||echo 1</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="435-逻辑操作符-1">4.3.5 逻辑操作符</h3>
<p><strong>在[]和test中 在(())和[[]]中 含义</strong></p>
<ul>
<li>-a &amp;&amp; 并且</li>
<li>-o || 或</li>
<li>！非</li>
</ul>
<h3 id="436-shell实例-1">4.3.6 shell实例</h3>
<h4 id="4361-比大小-1">4.3.6.1 比大小</h4>
<p>传参的方式比大小：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;USAGE:</span><span class="nv">$0</span><span class="s2"> avg1 avg2&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
expr <span class="nv">$1</span> + <span class="nv">$2</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -ne  <span class="m">0</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;please input num&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$1</span> -eq <span class="nv">$2</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">=</span><span class="nv">$2</span><span class="s2">&#34;</span>
  <span class="nb">exit</span> <span class="m">3</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$1</span> -gt <span class="nv">$2</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&gt;</span><span class="nv">$2</span><span class="s2">&#34;</span>
<span class="o">}||{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&lt;</span><span class="nv">$2</span><span class="s2">&#34;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>read方式比大小：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input num1&#34;</span> a
<span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input num2&#34;</span> b
<span class="o">[</span> -z <span class="nv">$a</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;error,please input number1&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
<span class="o">[</span> -z <span class="nv">$b</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;error,pleasr input number2&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
expr <span class="nv">$a</span> + <span class="nv">$b</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -ne  <span class="m">0</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;please input num&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$a</span> -eq <span class="nv">$b</span>  <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">=</span><span class="nv">$b</span><span class="s2">&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$a</span> -gt <span class="nv">$b</span> <span class="o">]&amp;&amp;{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&gt;</span><span class="nv">$b</span><span class="s2">&#34;</span>
<span class="o">}||{</span>
  <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&lt;</span><span class="nv">$b</span><span class="s2">&#34;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>扩展：针对判断整数的问题，可以有如下思路：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN</span>
123a
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># echo $LIXIN | sed s#[^0-9]##</span>
<span class="m">123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ &#34;`echo $LIXIN | sed s#[^0-9]##`&#34; = &#34;$LIXIN&#34; ] &amp;&amp; echo 1 || echo 0</span>
<span class="m">0</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># LIXIN=123</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># [ &#34;`echo $LIXIN | sed s#[^0-9]##`&#34; = &#34;$LIXIN&#34; ] &amp;&amp; echo 1 || echo 0</span>
<span class="m">1</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 把输入的字符串中的非数字替换为空，如果和源字符串相等，则表示输入的是数字。</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="4562-打印菜单-1">4.5.6.2 打印菜单</h4>
<p>要求：</p>
<ol>
<li>当用户输入1时，输出&rsquo;start installing lamp'，然后执行/server/scripts/lamp.sh，脚本内容输入&rsquo;lamp is installed&rsquo;后退出脚本；</li>
<li>当用户输入2时，输出&rsquo;start installing lnmp'，然后执行/server/scripts/lnmp.sh，脚本内容输入&rsquo;lnmp is installed&rsquo;后退出脚本；</li>
<li>当用户输入3时，退出当前菜单及脚本；</li>
<li>当输入任何其他字符，给出提示&rsquo;input error&rsquo;后退出脚本</li>
<li>要对执行的脚本进行相关条件判断，例如：脚本是否存在，是否可以执行等。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat menu.sh</span>
<span class="c1">#!/bin/bash</span>
man<span class="o">(){</span>
cat <span class="s">&lt;&lt;EOF
</span><span class="s">    1.install lamp
</span><span class="s">    2.install lnmp
</span><span class="s">    3.exit
</span><span class="s">    please input number
</span><span class="s">    EOF</span>
<span class="o">}</span>
man
<span class="nb">read</span> num
<span class="k">if</span> <span class="o">[</span> <span class="nv">$num</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;installing lamp.......&#34;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="nv">$num</span> -eq <span class="m">2</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;installing lnmp.......&#34;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="nv">$num</span> -eq <span class="m">3</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;good bye&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;input error&#34;</span>
    <span class="nb">exit</span> <span class="m">2</span>
<span class="k">fi</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># </span>
</code></pre></td></tr></table>
</div>
</div><h2 id="44-分支与循环结构-1">4.4 分支与循环结构</h2>
<h3 id="441-if条件语句-1">4.4.1 if条件语句</h3>
<p><strong>1. 单分支结构：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> 条件 <span class="o">]</span>
    <span class="k">then</span>
       指令
<span class="k">fi</span>
<span class="c1"># 或</span>
<span class="k">if</span> <span class="o">[</span> 条件 <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    指令
<span class="k">fi</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>2. 双分支结构：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> 条件 <span class="o">]</span>
    <span class="k">then</span>
       指令1
<span class="k">else</span>
    指令2
<span class="k">fi</span>
<span class="c1"># 类似：[ -f /etc/hosts ] &amp;&amp; echo 0 || echo 1</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>3. 多分支结构:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> 条件1 <span class="o">]</span>
    <span class="k">then</span>
       指令1
<span class="k">elif</span> <span class="o">[</span> 条件2 <span class="o">]</span>
    <span class="k">then</span> 指令2
<span class="c1"># .......可以有多个elif</span>
<span class="k">else</span>
  指令3
<span class="k">fi</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：开发shell脚本判断系统剩余内存的大小，如果低于100M，就邮件报警给管理员，并且加入系统定时任务每3分钟执行一次检查。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># tail -1 /etc/mail.rc</span>
<span class="nb">set</span> <span class="nv">from</span><span class="o">=</span>beyondlee2011@126.com <span class="nv">smtp</span><span class="o">=</span>smtp.126.com smtp-auth-user<span class="o">=</span>beyondlee2011 smtp-auth-password<span class="o">=</span>aini3845 smtp-auth<span class="o">=</span>login
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat memtest.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">mem</span><span class="o">=</span><span class="sb">`</span>free -m <span class="p">|</span> awk <span class="s1">&#39;NR==3{print $NF}&#39;</span><span class="sb">`</span>
<span class="o">[</span> <span class="nv">$mem</span> -le <span class="m">100</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
   <span class="nb">echo</span> <span class="s1">&#39;mail is sending to Administrator.......&#39;</span>
   <span class="nb">echo</span> <span class="s2">&#34;memory is </span><span class="nv">$mem</span><span class="s2">&#34;</span> <span class="p">|</span> mail -s <span class="s2">&#34;Warning:memory is not enough&#34;</span> 287990400@qq.com
<span class="o">}</span>
//定时任务
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># crontab -l</span>
*/3 * * * * /bin/bash /server/scripts/memtest.sh <span class="p">&amp;</span>&gt;/dev/null
</code></pre></td></tr></table>
</div>
</div><p>例子2：用if双分支实现对mysql服务是否正常进行判断，使用端口，进程数或者URL的方式拍段，如果进程没起动，把进行启动</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat testmysql.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">mysqlinfor</span><span class="o">=</span><span class="sb">`</span>netstat -lntup <span class="p">|</span> grep <span class="m">3306</span> <span class="p">|</span> grep -v grep <span class="p">|</span> wc -l<span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$mysqlinfor</span> -ge <span class="m">1</span> <span class="o">]</span> <span class="p">;</span><span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&#34;mysql is started&#34;</span>
  <span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;mysql is starting&#34;</span>
    /data/3306/mysql start <span class="p">&amp;</span>&gt;/dev/null
    sleep <span class="m">3</span>
    <span class="nb">echo</span> <span class="s2">&#34;ok&#34;</span>
<span class="k">fi</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子3：以read读入的方式比较两个数的带下，用if多分支来实现。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat testnum.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">read</span> -t <span class="m">10</span> -p <span class="s2">&#34;please input two number &#34;</span> a b
expr <span class="nv">$a</span> + <span class="nv">$b</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
<span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
  <span class="nb">echo</span> <span class="s2">&#34;please input number ok?&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
<span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
  <span class="nb">echo</span> <span class="s2">&#34;The First number is empty&#34;</span>
  <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>
<span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$b</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
  <span class="nb">echo</span> <span class="s2">&#34;The Seconed number is empty&#34;</span>
  <span class="nb">exit</span> <span class="m">3</span>
<span class="o">}</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span> -gt <span class="s2">&#34;</span><span class="nv">$b</span><span class="s2">&#34;</span> <span class="o">]</span>
  <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&gt;</span><span class="nv">$b</span><span class="s2">&#34;</span>
  <span class="k">elif</span> <span class="o">[</span> <span class="nv">$a</span> -lt <span class="s2">&#34;</span><span class="nv">$b</span><span class="s2">&#34;</span> <span class="o">]</span>
   <span class="k">then</span>
     <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&lt;</span><span class="nv">$b</span><span class="s2">&#34;</span>
  <span class="k">else</span>
   <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">=</span><span class="nv">$b</span><span class="s2">&#34;</span>
<span class="k">fi</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>扩展：<br>
判断mysql或者web服务共同方法：</p>
<ol>
<li>端口：<br>
本地：netstat/ss/lsof<br>
远程：telnet/nmap/nc命令</li>
<li>进程：<br>
本地：ps aux(ps -ef)</li>
<li>wget/curl(http方式，判断根据返回值或者返回内容)</li>
<li>header(http)，（根据状态码判断）</li>
<li>数据库特有，通过mysql客户端查看返回值</li>
</ol>
</blockquote>
<p>通过端口和进程判断：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;`netstat -lnt|grep 3306|awk -F &#34;</span><span class="o">[</span> :<span class="o">]</span>+<span class="s2">&#34; &#39;{print </span><span class="nv">$5</span><span class="s2">}&#39;`&#34;</span> <span class="o">=</span> <span class="s2">&#34;3306&#34;</span> <span class="o">]</span> 由于后面使用的是比较，所以如果使用-eq 进行比较的话，当mysql没有运行的时候，第一个变量就为空,所以<span class="o">[</span> <span class="s2">&#34;&#34;</span> -eq <span class="s2">&#34;3306&#34;</span> <span class="o">]</span>会报语法错误。所以使用<span class="o">=</span>号，用字符串进行比较。
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>ps -ef <span class="p">|</span> grep mysql <span class="p">|</span> grep -v grep <span class="p">|</span>wc -l<span class="sb">`</span> -gt <span class="m">0</span> <span class="o">]</span> 用这种方式比较的话，注意脚本的名称不要包含mysql
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>nc -w <span class="m">2</span> 10.0.0.7 <span class="m">3306</span> <span class="p">&amp;</span>&gt;/dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> ok <span class="p">|</span> grep ok <span class="p">|</span> wc -l<span class="sb">`</span> -gt <span class="m">0</span> <span class="o">]</span>
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>nmap 10.0.0.7 -p <span class="m">3306</span> 2&gt;/dev/null <span class="p">|</span> grep open <span class="p">|</span> wc -l <span class="sb">`</span> -gt <span class="m">0</span> <span class="o">]</span>
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>netstat -lntup <span class="p">|</span> grep mysqld <span class="p">|</span> wc -l <span class="sb">`</span> -gt <span class="m">0</span> <span class="o">]</span>
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>lsof -i tcp:3306 <span class="p">|</span> wc -l<span class="sb">`</span>  -gt <span class="m">0</span> <span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p>通过curl进行判断</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;`curl -I -s -o /dev/null -w &#34;</span>%<span class="o">{</span>http_code<span class="o">}</span><span class="se">\n</span><span class="s2">&#34; http://web`&#34;</span> <span class="o">=</span> <span class="s1">&#39;200&#39;</span> <span class="o">]</span> -I：取返回头。-s：静默模式。-o：输出信息到空。-w：只取返回值。
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>curl -I http://web 2&gt;/dev/null <span class="p">|</span> head -1 <span class="p">|</span> egrep <span class="s2">&#34;200|302|301&#34;</span> <span class="p">|</span> wc -l <span class="sb">`</span> -eq <span class="m">1</span> <span class="o">]</span> 默认情况下curl命令会带一些错误的头部信息，这个时候可以使用静默模式，或者使用2&gt;把错误信息输出到空
</code></pre></td></tr></table>
</div>
</div><p>范例：实现通过传参的方式往/etc/user.conf里添加用户，具体要求如下：</p>
<ol>
<li>脚本用法
USAGE：sh adduser {-add | -del | -search} username</li>
<li>传参需求
-add 表示添加，-del 表示删除， -search 表示查找</li>
<li>如果有同名的用户则不能添加，没有对应用户则无需删除，查找到用户以及没有用户时给出明确提示。</li>
<li>/etc/user.conf不能被所有外部用户直接删除及修改</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat adduser.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="o">[</span> <span class="nv">$UID</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">&#34;please use root&#34;</span>
    <span class="nb">exit</span> <span class="m">0</span>
<span class="o">}</span>
<span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">&#34;USAGE:sh /server/scripts/adduser { -add|-del|-search} username&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>
<span class="nv">cmd</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">user</span><span class="o">=</span><span class="nv">$2</span>
<span class="nv">user_info</span><span class="o">=</span><span class="sb">`</span>grep <span class="nv">$user</span> /etc/user.conf <span class="p">|</span> wc -l<span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;0&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-add&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2">&#34;</span> &gt;&gt; /etc/user.conf
        <span class="nb">echo</span> <span class="s2">&#34;adduser </span><span class="nv">$user</span><span class="s2"> successful!&#34;</span>
        <span class="nb">exit</span> <span class="m">2</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-add&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2"> is cunzai&#34;</span>
        <span class="nb">exit</span> <span class="m">3</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;0&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-del&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2"> is not create,please create it first&#34;</span>
        <span class="nb">exit</span> <span class="m">4</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span> -a  <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-del&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        sed -i <span class="s2">&#34;/</span><span class="nv">$user</span><span class="s2">/d&#34;</span> /etc/user.conf
        <span class="nb">echo</span> <span class="s2">&#34;del user </span><span class="nv">$user</span><span class="s2"> successsful!!!&#34;</span>
        <span class="nb">exit</span> <span class="m">5</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-search&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;0&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2"> is not create,please create it first&#34;</span>
        <span class="nb">exit</span> <span class="m">6</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$cmd</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;-search&#34;</span> -a <span class="s2">&#34;</span><span class="nv">$user_info</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;1&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$user</span><span class="s2"> is a good boy!&#34;</span>
        <span class="nb">exit</span> <span class="m">7</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;USAGE:sh /server/scripts/adduser { -add|-del|-search} username&#34;</span>
    <span class="nb">exit</span> <span class="m">8</span>
<span class="k">fi</span>
</code></pre></td></tr></table>
</div>
</div><p>面试及实战考试题：监控web站点目录(/var/html/www)下所有文件是否篡改（文件内容被改了），如果有就打印改动的文件名（发邮件），定时任务每3分钟执行一次。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat testweb.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">dir</span><span class="o">=</span>/var/www/html
<span class="nv">result</span><span class="o">=</span>/tmp/web.log
<span class="nv">ip</span><span class="o">=</span><span class="sb">`</span>ip addr ls eth0 <span class="p">|</span> awk -F <span class="s2">&#34;[ /]+&#34;</span> <span class="s1">&#39;NR==3{print $3}&#39;</span><span class="sb">`</span>
<span class="nv">error_file</span><span class="o">=</span>/tmp/error_file.log
<span class="o">[</span> -f <span class="nv">$result</span> <span class="o">]</span> <span class="o">||</span> <span class="o">{</span>
    find <span class="nv">$dir</span> -type f -name <span class="s2">&#34;*.html&#34;</span> <span class="p">|</span> xargs md5sum &gt;<span class="nv">$result</span>
<span class="o">}</span>

<span class="k">if</span> <span class="o">[</span> ! <span class="s2">&#34;`md5sum -c </span><span class="nv">$result</span><span class="s2"> 2&gt;/dev/null | grep FAILED | tee </span><span class="nv">$error_file</span><span class="s2"> | wc -l`&#34;</span> <span class="o">=</span> <span class="s2">&#34;0&#34;</span> <span class="o">]</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&#34;web is not safe&#34;</span>
        mail -s <span class="s2">&#34;</span><span class="nv">$ip</span><span class="s2"> is not safe&#34;</span> daxin.li@foxmail.com &lt; <span class="nv">$error_file</span>
        mv <span class="nv">$result</span> /root/<span class="k">$(</span>date +%F<span class="k">)</span>_web_error.log
<span class="k">fi</span>
<span class="c1"># 保存退出</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#  crontab -l</span>
*/3 * * * * /bin/bash /server/scripts/testweb.sh <span class="p">&amp;</span>&gt;/dev/null
</code></pre></td></tr></table>
</div>
</div><h3 id="442-case结构条件句-1">4.4.2 case结构条件句</h3>
<p>case语句实际上就是规范的多分支if语句<br>
<strong>基本语法：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">case</span> <span class="s2">&#34;字符串变量&#34;</span> in
    值1<span class="o">)</span> 指令1..
<span class="p">;;</span>
    值2<span class="o">)</span> 指令2..
<span class="p">;;</span>
    值*<span class="o">)</span> 指令3..
<span class="k">esac</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：根据用户驶入判断是哪个数字，如果用户输入1或2或3，则输出对应输入的数字，如果是其他内容，返回不正确，退出</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat case1.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">a</span><span class="o">=</span><span class="nv">$1</span>
<span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span> in
    1<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    2<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    3<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;input error&#34;</span>
<span class="k">esac</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：执行脚本打印一个水果菜单如下：</p>
<ol>
<li>apple</li>
<li>pear</li>
<li>banana</li>
<li>cherry</li>
</ol>
<p>当用户选择水果的时候，打印告诉它选择的水果是什么，并给水果单词加上一种颜色。要求用case语句实现。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat case2.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">RED</span><span class="o">=</span><span class="s2">&#34;\033[31m&#34;</span>
<span class="nv">GREEN</span><span class="o">=</span><span class="s2">&#34;\033[32m&#34;</span>
<span class="nv">YELLO</span><span class="o">=</span><span class="s2">&#34;\033[33m&#34;</span>
<span class="nv">BLUE</span><span class="o">=</span><span class="s2">&#34;\033[34m&#34;</span>
<span class="nv">PINK</span><span class="o">=</span><span class="s2">&#34;\033[35m&#34;</span>
<span class="nv">END</span><span class="o">=</span><span class="s2">&#34;\033[0m&#34;</span>

cat <span class="s">&lt;&lt; EOF
</span><span class="s">    1.apple
</span><span class="s">    2.pear
</span><span class="s">    3.banana
</span><span class="s">    4.cherry
</span><span class="s">    please input your choice
</span><span class="s">EOF</span>

<span class="nb">read</span> -t <span class="m">10</span> Fruit
<span class="k">case</span> <span class="nv">$Fruit</span> in
    1<span class="o">)</span> <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$RED</span><span class="s2"> apple </span><span class="nv">$END</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    2<span class="o">)</span> <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$GREEN</span><span class="s2"> pear </span><span class="nv">$END</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    3<span class="o">)</span> <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$BLUE</span><span class="s2"> banana </span><span class="nv">$END</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    4<span class="o">)</span> <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$PINK</span><span class="s2"> cherry </span><span class="nv">$END</span><span class="s2">&#34;</span>
<span class="p">;;</span>
    *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;please input {1|2|3|4}&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="k">esac</span>
</code></pre></td></tr></table>
</div>
</div><p>范例3：开发一个给指定内容加指定颜色的脚本要求：1.使用read或传参实现：2.case实现3.以传参为例：在脚本命令行传2个参参数，给指定内容(是第一个参数)加指定颜色（是第二个参数）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat color_case.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">RED</span><span class="o">=</span><span class="s2">&#34;\033[31m&#34;</span>
<span class="nv">GREEN</span><span class="o">=</span><span class="s2">&#34;\033[32m&#34;</span>
<span class="nv">YELLOW</span><span class="o">=</span><span class="s2">&#34;\033[33m&#34;</span>
<span class="nv">BLUE</span><span class="o">=</span><span class="s2">&#34;\033[34m&#34;</span>
<span class="nv">PINK</span><span class="o">=</span><span class="s2">&#34;\033[35m&#34;</span>
<span class="nv">END</span><span class="o">=</span><span class="s2">&#34;\033[0m&#34;</span>

Usage<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;Please input color and character!&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>

Color<span class="o">(){</span>
<span class="k">case</span> <span class="nv">$1</span> in
    RED<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$RED</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>
    <span class="p">;;</span>
    GREEN<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$GREEN</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>
    <span class="p">;;</span>
    YELLOW<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$YELLO</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>
    <span class="p">;;</span>
    BLUE<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$BLUE</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>  
    <span class="p">;;</span>
    PINK<span class="o">)</span>
        <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$PINK</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
        <span class="nb">exit</span> <span class="m">0</span>
    <span class="p">;;</span>
    *<span class="o">)</span>
        <span class="nb">echo</span> <span class="s2">&#34;color is {RED|GREEN|YELLO|BLUE|PINK}&#34;</span>
        <span class="nb">exit</span> <span class="m">2</span>
    <span class="k">esac</span>
<span class="o">}</span>

main<span class="o">(){</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]</span>
        <span class="k">then</span>
            Usage
    <span class="k">fi</span>
    Color <span class="nv">$1</span> <span class="s2">&#34;</span><span class="nv">$2</span><span class="s2">&#34;</span>
<span class="o">}</span>
main <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>小结：</p>
<ol>
<li>case语句就相当于多分支的if语句。case语句优势更规范.易读。</li>
<li>case语句适合变量的值少，且为固定对的数字或字符串集合</li>
<li>系统服务启动脚本传参的判断多用case语句（值是固定的start|stop|status）</li>
</ol>
<h1 id="5-循环-1">5 循环</h1>
<p>        while循环工作中使用的不多，一般是守护进程或始终循环执行的场景会用，其他循环计算，都会用for替换while。</p>
<h2 id="51-当型循环和直到循环-1">5.1 当型循环和直到循环</h2>
<p><strong>1. while 条件句</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 语法：</span>
<span class="k">while</span> 条件
    <span class="k">do</span>
        指令
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>2. until 条件句 （很少用）</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 语法</span>
<span class="k">until</span> 条件
    <span class="k">do</span>
        指令
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="52-sleep休息命令-1">5.2 sleep休息命令</h2>
<p>语法：sleep 时间（单位是秒）<br>
扩展：usleep 微秒（1秒等于1,000,000微秒）<br>
注意：超过1分钟，要使用定时任务。<br>
例子：每隔两秒输出一个负载值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="k">while</span> <span class="nb">true</span>
    <span class="k">do</span>
        cat <span class="s">&lt;&lt; EOF
</span><span class="s">-----------------------------------------------------------------------------
</span><span class="s">EOF</span>
    uptime
    sleep <span class="m">2</span>
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>注意：while true表示条件永远为真，即永远执行下去。</p>
<h2 id="53-前后台运行-1">5.3 前后台运行</h2>
<p>        在执行脚本的时候加上&amp;，表示后台执行<br>
防止客户端执行脚本中的方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">1. sh scripts.sh <span class="p">&amp;</span>
2. nohup /server/scripts/scripts.sh <span class="p">&amp;</span>
3. screen 命令
</code></pre></td></tr></table>
</div>
</div><p>其他操作：</p>
<ul>
<li>&amp;：放在后台执行</li>
<li>jobs：查看当前窗口后台或暂停的任务</li>
<li>fg ID：把某一个任务调整到前台</li>
<li>bg ID：把某一个任务重新调成到后台</li>
<li>kill %ID：杀掉一个任务</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># sh while3.sh &amp;</span>
<span class="o">[</span>1<span class="o">]</span> <span class="m">67583</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># jobs</span>
<span class="o">[</span>1<span class="o">]</span>+  Running                 sh while3.sh <span class="p">&amp;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># kill %1</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># jobs</span>
<span class="o">[</span>1<span class="o">]</span>+  Terminated              sh while3.sh
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># jobs</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="54-while循环-1">5.4 while循环</h2>
<p>例子：计算1+&hellip;+100之和</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 方法1：</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim while_sum.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span>  <span class="o">((</span> <span class="nv">$i</span> &lt;<span class="o">=</span> <span class="m">100</span> <span class="o">))</span>
    <span class="k">do</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
        <span class="o">((</span>i++<span class="o">))</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>

<span class="c1"># 方法2：</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim while_sum.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span> <span class="o">[</span> <span class="nv">$i</span> -le <span class="m">100</span> <span class="o">]</span>
    <span class="k">do</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
        <span class="o">((</span>i++<span class="o">))</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>
</code></pre></td></tr></table>
</div>
</div><p>例2：列出10到1的所有数字</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat while_num.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span><span class="m">10</span>
<span class="k">while</span> <span class="o">[</span> <span class="nv">$i</span> -ge <span class="m">1</span> <span class="o">]</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
        <span class="o">((</span>i--<span class="o">))</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>练习题</p>
<ol>
<li>
<p>猜数字游戏：首先让系统随机生成一个数字，给这个数字定一个范围（数字前50及后50），让用户输入猜的数字，对输入判断，如果不符合数字就给予高与低的提示，猜对后给下猜对用的次数，请用while语句实现。</p>
</li>
<li>
<p>手机充值10元，每发一次短信（输出当前余额）花费1角5分钱，当余额低于1角5分钱不能发短信，提示余额不足，请充值(可以允许用户充值继续发短信)，请用while语句实现。
解答：单位换算。统一单位，统一成整数，10元=1000分，1角5分=15分</p>
</li>
</ol>
<h3 id="541-while循环读文件-1">5.4.1 while循环读文件</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 方式1：</span>
<span class="nb">exec</span> &lt; file
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        cmd
<span class="k">done</span>

<span class="c1"># 方式2：</span>
cat <span class="nv">$file_path</span><span class="p">|</span><span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        cmd
<span class="k">done</span>

<span class="c1">#方式3：</span>
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        cmd
<span class="k">done</span> &lt; FILE
</code></pre></td></tr></table>
</div>
</div><p>例子：记录日志中访问的文件的大小，并做加法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat access.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">i</span><span class="o">=</span><span class="m">0</span>
<span class="nv">sum</span><span class="o">=</span><span class="m">0</span>
<span class="nb">exec</span> &lt; /root/access.log
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        <span class="nv">i</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span> awk <span class="s1">&#39;{print $10}&#39;</span> <span class="p">|</span> grep -E <span class="s1">&#39;[0-9]+&#39;</span><span class="sb">`</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
<span class="k">done</span>
    <span class="nb">echo</span> <span class="nv">$sum</span>
<span class="c1"># 注意：由于有些访问客户端本地会缓存所以它不会下载，一般这种访问的大小为-，我这里做了grep过滤，即只把数字过滤出来，另一种方法为：</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># vim access_new.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        <span class="nv">i</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span> awk <span class="s1">&#39;{print $10}&#39;</span><span class="sb">`</span>
        expr <span class="nv">$i</span> + <span class="m">1</span> <span class="p">&amp;</span>&gt;/dev/null
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="k">continue</span>
        <span class="k">fi</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
<span class="k">done</span> &lt; /root/access.log
<span class="nb">echo</span> <span class="nv">$sum</span>
<span class="c1"># 解答：如果$i,不是数字，利用expr的方法判断是否是数字，不是的话，利用continue跳出本次循环，继续下一次。即不是数字的行不加</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：一个httpd.log日志10个IP记录，每十秒钟一个导出到nginx.log里，倒腾到nginx.log里和httpd.log内容一样。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat quip.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">while</span> <span class="nb">read</span> line
    <span class="k">do</span>
        <span class="nv">apple2</span><span class="o">=</span><span class="sb">`</span>grep <span class="nv">$line</span> /root/nginx.log <span class="p">|</span> wc -l <span class="sb">`</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$apple2</span> -eq <span class="m">0</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="nb">echo</span> <span class="nv">$line</span> &gt;&gt; /root/nginx.log
                sed -i <span class="s2">&#34;/</span><span class="nv">$line</span><span class="s2">/d&#34;</span> /root/httpd.log
                sleep <span class="m">10</span>
                <span class="k">continue</span>
        <span class="k">else</span>
            <span class="nb">echo</span> <span class="s2">&#34;the ip </span><span class="nv">$line</span><span class="s2"> are ready in /root/nginx.log&#34;</span>
            <span class="k">continue</span>
        <span class="k">fi</span>
<span class="k">done</span> &lt; /root/httpd.log
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># </span>
</code></pre></td></tr></table>
</div>
</div><h3 id="542-while循环小结-1">5.4.2 while循环小结</h3>
<ol>
<li>while循环的特长是执行守护进程以及我们系统循环不退出持续执行的情况，用于频率小于1分钟循环处理(crond)，其他的while循环几乎都可以被for替代。</li>
<li>if.for最常用.其次（守护进程），case（服务启动脚本）。</li>
</ol>
<h2 id="55-for循环-1">5.5 for循环</h2>
<ol>
<li>常规语法：</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">for</span> 变量 in 变量取值列表
<span class="k">do</span>
       指令
<span class="k">done</span>
<span class="c1"># 提示：在此结构中“in 变量取值列表” 可省略，使用for i 就相当于 for i in &#34;$@&#34;</span>
</code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>C语言型语法结构</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">for</span><span class="o">((</span>exp1<span class="p">;</span>exp2<span class="p">;</span>exp3<span class="o">))</span>
    <span class="k">do</span>
        指令
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：for和while对比</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;5<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="c1"># 对应的while循环实现方式</span>
<span class="nv">i</span><span class="o">=</span><span class="m">0</span>
<span class="k">while</span> <span class="o">((</span>i&lt;5<span class="o">))</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
        <span class="o">((</span>i++<span class="o">))</span>
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test3.sh</span>
<span class="c1">#!/bin.bash</span>
<span class="k">for</span> i in <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span> <span class="m">10</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>

<span class="c1"># 升级方法1</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test4.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> i in <span class="o">{</span>1..10<span class="o">}</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1">#升级方法2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test4.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> i in <span class="sb">`</span>seq 10<span class="sb">`</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：批量生成10个名称任意的文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test6.sh</span>
<span class="c1">#!/bin/bash</span>
mkdir ./test
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;10<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        touch ./test/<span class="sb">`</span><span class="nb">echo</span> <span class="nv">$RANDOM</span><span class="p">|</span>md5sum<span class="p">|</span>cut -c 1-8<span class="sb">`</span>.log
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子，批量改文件后缀名</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 test<span class="o">]</span><span class="c1"># ls</span>
01e2c72d.log  3a14455d.log  3be873ce.log  44902678.log  783e7809.log  7f1fcb3c.log  c4c2399d.log  d55801a9.log  f8e1527b.log
0d339dcf.log  3bc67de9.log  3d90e27a.log  77d45895.log  7a93b22e.log  a29613b1.log  c6909d86.log  ea69f47e.log  fa601ba4.log 

<span class="c1"># 方法1:</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test7.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">cd</span> /root/test
<span class="k">for</span> i in <span class="sb">`</span>find /root/test/ -name <span class="s2">&#34;*.log&#34;</span><span class="sb">`</span>
    <span class="k">do</span>
        <span class="nv">name</span><span class="o">=</span><span class="sb">`</span> <span class="nb">echo</span> <span class="nv">$i</span> <span class="p">|</span> awk -F <span class="s1">&#39;.&#39;</span> <span class="s1">&#39;{print $1}&#39;</span><span class="sb">`</span>
        mv <span class="nv">$i</span> <span class="si">${</span><span class="nv">name</span><span class="si">}</span>.html
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 方法2：（变量的替换功能）</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># vim test8.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">cd</span> /root/test
<span class="k">for</span> i in <span class="sb">`</span>ls<span class="sb">`</span>
    <span class="k">do</span>
        mv <span class="nv">$i</span> <span class="si">${</span><span class="nv">i</span><span class="p">/.html/.jpg</span><span class="si">}</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 方法3：拼接功能</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test9.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">cd</span> /root/test
<span class="k">for</span> i in <span class="sb">`</span>ls<span class="sb">`</span>
    <span class="k">do</span>
        mv <span class="nv">$i</span> <span class="sb">`</span><span class="nb">echo</span> <span class="nv">$i</span> <span class="p">|</span> sed <span class="s1">&#39;s#.jpg#.log#g&#39;</span><span class="sb">`</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 方法4:通过rename改名</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># vim test10.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nb">cd</span> /root/test
<span class="k">for</span> i in <span class="sb">`</span>ls<span class="sb">`</span>
    <span class="k">do</span>
        rename <span class="s2">&#34;.log&#34;</span> <span class="s2">&#34;.jpg&#34;</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
rename <span class="s2">&#34;把什么&#34;</span> <span class="s2">&#34;改成什么&#34;</span>  对谁修改
</code></pre></td></tr></table>
</div>
</div><p>例子：批量修改chkconfig管理</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># vim test11.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> i in <span class="sb">`</span>chkconfig --list <span class="p">|</span> grep 3:on <span class="p">|</span>awk <span class="s1">&#39;{print $1}&#39;</span><span class="p">|</span> grep -Ev <span class="s2">&#34;network|crond|rsyslog|sshd|sysstat&#34;</span><span class="sb">`</span>
    <span class="k">do</span>
        chkconfig <span class="nv">$i</span> off
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：利用for命令计算1..100的和</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># C语言型：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test12.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">sum</span><span class="o">=</span><span class="m">0</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span>100<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="o">((</span><span class="nv">sum</span><span class="o">+=</span>i<span class="o">))</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 普通型：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test13.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">sum</span><span class="o">=</span><span class="m">0</span>
<span class="k">for</span> i in <span class="sb">`</span>seq 100<span class="sb">`</span>
    <span class="k">do</span>
        <span class="nb">let</span> <span class="nv">sum</span><span class="o">+=</span>i
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>练习题：等差数列,计算n-m的累加之和可以用等差公式m(n+m)/2</p>
<h2 id="56-循环控制-1">5.6 循环控制</h2>
<p>$shell循环控制主要有四种方式：break、continue、exit、return。</p>
<ol>
<li>break、continue、exit一般用于循环结构中控制循环（for，while，if）的走向</li>
<li>break n：n表示跳出循环的层数，如果省略n，表示跳出整个循环</li>
<li>continue n：n表示退出到第n层继续循环，如果省略n表示跳过本次循环，忽略本次循环的声誉代码，进入循环的下一次循环</li>
<li>exit n：退出当前shell程序，n为返回值，n也可以省略，再下一个shell里通过$?接收这个n的值。</li>
<li>return n：由于在函数里，作为函数的返回值，用于判断函数执行是否正确。</li>
</ol>
<p>例子1：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test15.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span>5<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$i</span> -eq <span class="m">3</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="c1">#break</span>
                <span class="nb">exit</span>
                <span class="c1">#continue</span>
        <span class="k">fi</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s1">&#39;OK&#39;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># sh test15.sh</span>
<span class="m">1</span>
<span class="m">2</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 注意：由于使用了exit，所以在循环到第三次的时候，就直接退出了脚本</span>
</code></pre></td></tr></table>
</div>
</div><p>例子2：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test15.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span>5<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$i</span> -eq <span class="m">3</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="c1">#break</span>
                <span class="c1">#exit</span>
                <span class="k">continue</span>
        <span class="k">fi</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s1">&#39;OK&#39;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># sh test15.sh</span>
<span class="m">1</span>
<span class="m">2</span>
<span class="m">4</span>
<span class="m">5</span>
OK
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 注意：由于使用了continue，所以在执行到第三次的时候，结束本次循环，继续执行下一次循环。</span>
</code></pre></td></tr></table>
</div>
</div><p>例子3：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat test15.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;</span>i&lt;<span class="o">=</span>5<span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$i</span> -eq <span class="m">3</span> <span class="o">]</span>
            <span class="k">then</span>
                <span class="nb">break</span>
                <span class="c1">#exit</span>
                <span class="c1">#continue</span>
        <span class="k">fi</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s1">&#39;OK&#39;</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># sh test15.sh</span>
<span class="m">1</span>
<span class="m">2</span>
OK
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 注意：由于使用了break，当执行到第三次的时候，跳出循环，继续执行其他命令。</span>
</code></pre></td></tr></table>
</div>
</div><p>练习题：开发shell脚本实现给服务器临时配置多个别名IP，并可以随时撤销配置的所以IP，IP地址为10.0.2.1-16，其中10.0.2.10不能配置。</p>
<h1 id="6-shell函数-1">6 shell函数</h1>
<p>        $简单的说，函数的作用就是把程序里多次调用相同的代码部分定义成一份，然后为这一份代码起个名字，其他所有的重复调用这部分代码就都可以只调用这个名字就OK了。当需要修改在这部分重复代码时，只需要改变函数体内的一份代码即可实现 所有调用修改。</p>
<h2 id="61-为什么要使用shell函数-1">6.1 为什么要使用shell函数</h2>
<p>使用函数的优势：</p>
<ol>
<li>把相同的程序段定义成函数，可以减少整个程序的代码量。</li>
<li>可以让程序代码结构更清晰。</li>
<li>增加程序的可读、易读性，以及可管理性。</li>
<li>可以实现程序功能模块化，不同的程序使用函数模块化。  <br>
<strong>注意：对应shell来说，linux的2000多个命令都可以说是shell的函数。</strong></li>
</ol>
<h2 id="62-shell函数语法-1">6.2 shell函数语法</h2>
<p>简单的语法格式:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">函数名称<span class="o">(){</span>
   指令...
   <span class="k">return</span> n
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>规范的语法格式:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">function</span> 函数名<span class="o">(){</span>
   指令...
   <span class="k">return</span> n
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>提示：shell的返回值是exit输出返回值，函数里用return输出返回值。</p>
<h2 id="63-shell的函数执行-1">6.3 shell的函数执行</h2>
<ol>
<li>直接执行函数名即可（不带括号）
<ul>
<li>执行函数的时候，不要带小括号。</li>
<li>函数的定义必须在函数调用前定义，shell的执行是从上到下按行执行的。</li>
</ul>
</li>
<li>带参数的函数执行方法：
<ul>
<li>函数名 参数1 参数2</li>
<li>函数的传参和脚本的传参类似，只是脚本名换成函数名即可。</li>
</ul>
</li>
</ol>
<p>注意：</p>
<ul>
<li>shell的位置参数($1、$2、$#、$*、$?、$@)都可以是函数的参数。</li>
<li>此时父脚本的参数临时地被函数参数所掩盖或隐藏。</li>
<li>$0比较特使，它仍是父脚本的名称。</li>
<li>当函数完成时，原来的命令行脚本的参数即恢复。</li>
<li>在shell函数里面，return命令功能与shell里的exit类似，作用是跳出函数。</li>
<li>在shell函数里使用exit会退出整个shell脚本，而不是退出shell函数。</li>
<li>return语句会返回一个退出值（返回值）给调用函数的程序。</li>
<li>函数的参数变量是在函数体里面定义，如果是普通变量一般会使用local i定义（函数里面的变量，只在本函数中生效）。</li>
</ul>
<p>实例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat hanshu.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="k">function</span> main<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;hello,i am handsome man&#34;</span>
<span class="o">}</span>
main
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># sh hanshu.sh</span>
hello,i am handsome man
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>注意:引用其他脚本的函数的时候，可以在本脚本中通过source或者.来调用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat hanshu.sh</span>
<span class="c1">#!/bin/bash</span>
. /etc/init.d/functions
<span class="k">function</span> main<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;hello,i am handsome man&#34;</span>
    action <span class="s2">&#34;is is ok&#34;</span> /bin/true
<span class="o">}</span>
main
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># sh hanshu.sh</span>
hello,i am handsome man
is is ok                                                   <span class="o">[</span>  OK  <span class="o">]</span>
<span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>例子：函数传参转成脚本命令传参，对任意指定URL判断是否异常。</p>
<ol>
<li>脚本传参检查url是否正常。</li>
<li>脚本的功能写成函数</li>
<li>函数传参转成脚本命令行传参，对任意指定的URL进行判断。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat testurl.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="o">[</span> -f /etc/init.d/functions <span class="o">]</span> <span class="o">&amp;&amp;</span> . /etc/init.d/functions
Usage<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;USAGE:</span><span class="nv">$0</span><span class="s2"> url&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>

testurl<span class="o">(){</span>
    <span class="nb">local</span> code
    <span class="nv">code</span><span class="o">=</span><span class="sb">`</span>curl -I -s <span class="nv">$1</span> -w <span class="s1">&#39;%{http_code}&#39;</span> --connect-timeout <span class="m">3</span> -o /dev/null<span class="sb">`</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$code</span> -eq <span class="m">200</span> <span class="o">]</span>
        <span class="k">then</span>
            action <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2"> url&#34;</span> /bin/true
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">fi</span>
    action <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2"> url&#34;</span> /bin/false
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>

main<span class="o">(){</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">1</span> <span class="o">]</span>
        <span class="k">then</span>
            Usage
    <span class="k">fi</span>
        testurl <span class="nv">$1</span>
<span class="o">}</span>
main <span class="nv">$*</span>
<span class="c1"># 注意：$*加上引号，才表示是一个变量，$*会把命令行的参数都传给shell脚本，比如我输入sh testurl.sh www.baidu.com www.qq.com,$*会直接把www.baidu.com www.qq.com传给shell，由于中间有空格，所以shell函数认为是两个变量，所以会报错。</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="631-shell脚本字体颜色-1">6.3.1 shell脚本字体颜色</h3>
<p>字体颜色：30-37</p>
<blockquote>
<p>echo -e &ldquo;\033[30m 黑色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[31m 红色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[32m 绿色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[33m 黄色字 \033[0m&rdquo; <br>
echo -e &ldquo;\033[34m 蓝色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[35m 紫色字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[36m 天蓝字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[37m 白色字 \033[0m&rdquo;</p>
</blockquote>
<p>字背景颜色范围：40-47</p>
<blockquote>
<p>echo -e  &ldquo;\033[40;37m 黑底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[41;37m 红底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[42;37m 绿底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[43;37m 黄底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[44;37m 蓝底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[45;37m 紫底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[46;37m 天蓝底白字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[47;30m 白底黑字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[41;33m 红底黄字 \033[0m&rdquo;<br>
echo -e &ldquo;\033[41;37m 红底白字 \033[0m&rdquo;</p>
</blockquote>
<p><strong>可以通过man console_code来查询</strong><br>
实例：传递两个参数给脚本，并打印对应颜色的字体</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 scripts<span class="o">]</span><span class="c1"># cat color.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">RED</span><span class="o">=</span><span class="s2">&#34;\033[31m&#34;</span>
<span class="nv">GREEN</span><span class="o">=</span><span class="s2">&#34;\033[32m&#34;</span>
<span class="nv">YELLO</span><span class="o">=</span><span class="s2">&#34;\033[33m&#34;</span>
<span class="nv">BLUE</span><span class="o">=</span><span class="s2">&#34;\033[34m&#34;</span>
<span class="nv">PINK</span><span class="o">=</span><span class="s2">&#34;\033[35m&#34;</span>
<span class="nv">END</span><span class="o">=</span><span class="s2">&#34;\033[0m&#34;</span>
Usage<span class="o">(){</span>
    <span class="nb">echo</span> <span class="s2">&#34;Please input color and character!&#34;</span>
    <span class="nb">exit</span> <span class="m">1</span>
<span class="o">}</span>

Color<span class="o">(){</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;RED&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$RED</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;GREEN&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$GREEN</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;YELLO&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$YELLO</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;BLUE&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$BLUE</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
   <span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;PINK&#34;</span> <span class="o">]</span>
        <span class="k">then</span>
            <span class="nb">echo</span> -e <span class="s2">&#34;</span><span class="nv">$PINK</span><span class="s2"> </span><span class="nv">$2</span><span class="s2"> </span><span class="nv">$END</span><span class="s2">&#34;</span>
            <span class="nb">exit</span> <span class="m">0</span>
    <span class="k">fi</span>
        <span class="nb">echo</span> <span class="s2">&#34;color is {RED|GREEN|YELLO|BLUE|PINK}&#34;</span>
        <span class="nb">exit</span> <span class="m">2</span>
<span class="o">}</span>

main<span class="o">(){</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">2</span> <span class="o">]</span>
        <span class="k">then</span>
            Usage
    <span class="k">fi</span>
    Color <span class="nv">$1</span> <span class="nv">$2</span>
<span class="o">}</span>
main <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="7-shell数组-1">7 shell数组</h1>
<p>平时定义a1,b=2,c=3,变量如果多了，再一个一个定义很费劲，并且去变量也很费劲。<br>
简单的说，数组就是各种数据类型的元素按一定顺序排列的集合。<br>
数组就是把有限个元素变量或数据用一个名字命名，然后用编号区分他们的变量的集合。这个名字成为数组名，编号成为数组下标<br>
组成数组的各个变量成为数组的分量，也成为数组的元素，有时也成为下标变量。</p>
<h2 id="71-数组的定义-1">7.1 数组的定义</h2>
<p><strong>array=(1 2 3)</strong><br>
数组是一个特殊的变量。其中数组名为array，里面有3个元素，可以使用 <code>echo ${#array[*]}</code> ,来查看数组的长度。这里*和@都可以。<br>
注意：数组的下标从0开始，即0代表取数组内第一个数据<br>
例子：循环打印出数组中的IP地址</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 方法1：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat array.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">array</span><span class="o">=(</span>
    10.0.0.1
    10.0.0.2
    10.0.0.3
<span class="o">)</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;<span class="si">${#</span><span class="nv">array</span><span class="p">[*]</span><span class="si">}</span><span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="si">${</span><span class="nv">array</span><span class="p">[i]</span><span class="si">}</span>
<span class="k">done</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>

<span class="c1"># 方法2：</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># cat array1.sh</span>
<span class="c1">#!/bin/bash</span>
<span class="nv">array</span><span class="o">=(</span>
    10.0.0.1
    10.0.0.2
    10.0.0.3
<span class="o">)</span>
<span class="k">for</span> i in <span class="si">${</span><span class="nv">array</span><span class="p">[*]</span><span class="si">}</span>
    <span class="k">do</span>
        <span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>
 
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="72-向数组的添加值-1">7.2 向数组的添加值</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># array=(1 2 3)</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># array[3]=4</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>7.3 删除数组中的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
<span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># unset array[0]</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
<span class="m">2</span> <span class="m">3</span> <span class="m">4</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><p>7.4 把命令的结果定义成array</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 方法1，通过$()取命令的结果</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># array=($(ls))</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[*]}</span>
2016-07-01_web_error.log access.log array1.sh array.sh eluosi.sh for_sum.sh fruit.sh kuang2 menu.sh daxin.log daxinxin.log quip.sh <span class="nb">test</span> test10.sh test11.sh test12.sh test13.sh test14.sh test15.sh test1.sh test2.sh test3.sh test4.sh test5.sh test6.sh test7.sh test8.sh test9.sh test.sh while1.sh while2.sh while3.sh <span class="k">while</span>.sh
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
<span class="c1"># 方法2：通过``取命令的结果</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># array=(`ip a l | grep eth | grep inet | awk &#39;{print $NF}&#39;`)</span>
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1"># echo ${array[@]}</span>
eth0 eth1
<span class="o">[</span>root@CentOS6 ~<span class="o">]</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="75-小结-1">7.5 小结</h2>
<ol>
<li>定义
<ul>
<li>静态数组:array=(1 2 3)</li>
<li>动态数组：array=($(ls))</li>
<li>给数组赋值：array[1]=2</li>
</ul>
</li>
<li>打印
<ul>
<li>打印所有元素：${array[*]}或${array[@]}</li>
<li>打印数组长度：${#array[*]}或${#array[@]}</li>
<li>打印单个元素：${array[i]},i是数组的下标</li>
</ul>
</li>
</ol>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">daxin.li</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2016-12-26
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content">原创文章，如需转载请注明文章作者和出处。谢谢！</span>
  </p>
</div>


    
    
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    
      <label class="qr-code-image" for="reward">
        <img class="image" src="/static/wechat-qr-code.png">
        <span>微信打赏</span>
      </label>
    
      <label class="qr-code-image" for="reward">
        <img class="image" src="/static/alipay-qr-code.png">
        <span>支付宝打赏</span>
      </label>
  </div>
</div>

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://dachenzi.github.io/tags/content_a/">content_a</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/2-nginx%E5%AE%89%E8%A3%85echo%E6%A8%A1%E5%9D%97/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">2-nginx安装echo模块</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/3-django-template%E6%A8%A1%E6%9D%BF%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">
            <span class="next-text nav-default">3-django-template模板基本使用</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  
  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "dachenzi/dachenzi.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:dahlhin.li@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/dachenzi" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://weibo.com/2401416804/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo" rel="me noopener" class="iconfont"
      title="weibo"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-0.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-0.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"></path>
</svg>

    </a>
  
    <a href="https://www.zhihu.com/people/da-chen-zi-67" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>


<a href="https://dachenzi.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2016 -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        daxin.li
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>



  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>









  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
